"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[75435,88746],{173777:(e,t,s)=>{s.d(t,{SEPARATOR_PREFIX:()=>i,isSeparatorItem:()=>r});const i="###";function r(e){return e.startsWith(i)}},257380:(e,t,s)=>{s.d(t,{WatchedObject:()=>o});var i=s(262325),r=s.n(i),n=s(270617);function a(e,t){return(0,n.deepEquals)(e,t)[0]}class o extends(r()){constructor(e,t=a){super(e),this._comparator=t}setValue(e,t){!1===this._comparator(this.value(),e)&&super.setValue(e,t)}}},588746:(e,t,s)=>{s.r(t),s.d(t,{TVAction:()=>r,TVActionAsync:()=>n,TVLoader:()=>a});var i=s(829770);class r extends i.Action{constructor(e,t){super({...e,actionId:"TVActionId"},t)}getState(){return{...super.getState(),jsxLabel:this._options.jsxLabel}}}class n extends i.ActionAsync{constructor(e){super("TVActionId",e)}}class a extends r{constructor(){super({})}isLoading(){return!0}getSize(){return"big"}}},1891:(e,t,s)=>{s.r(t),s.d(t,{ContextMenuManager:()=>i});var i,r=s(829770),n=s(224743);!function(e){let t=null,i=null;const a=[],o={createAction:e=>new r.Action({...e,actionId:"Chart.CustomActionId"}),createAsyncAction:e=>new r.ActionAsync("Chart.CustomActionId",e),createSeparator:()=>new r.Separator};async function l(e,r={},n={menuName:""},l){let d;null!==t&&(e=await t(e,o));const u=()=>{const e=a.indexOf(d);-1!==e&&a.splice(e,1),void 0!==l&&l()};if(null!==i)d=await i(e,n,u),h();else{const t=await Promise.all([s.e(8348),s.e(5979),s.e(21834),s.e(78941),s.e(44155),s.e(24384),s.e(74733),s.e(11812),s.e(24782),s.e(87995),s.e(7315),s.e(91584)]).then(s.bind(s,37091));d=new t.ContextMenuRenderer(e,r,u,h)}return a.push(d),d}function h(){(0,n.globalCloseMenu)()}e.createMenu=l,e.showMenu=function(e,t,s={},i,r){return l(e,s,i,r).then((e=>e.show(t)))},e.setCustomRendererFactory=function(e){i=e},e.setCustomItemsProcessor=function(e){t=e},e.hideAll=h,e.getShown=function(){for(let e=0;e<a.length;e++)if(a[e].isShown())return a[e];return null}}(i||(i={}))},214318:(e,t,s)=>{s.d(t,{isCustomStudy:()=>r});const i={LinearRegression:!0,PivotPointsHighLow:!0,VbPSessions:!0,VbPSessionsRoughDetailed:!0,VbPPeriodic:!0,VbPAutoAnchored:!0,ZigZag:!0,VbPFixed:!0,PivotPointsStandard:!0,VbPVisible:!0};function r(e){return e in i}},333412:(e,t,s)=>{s.d(t,{MetaInfoHelper:()=>c});var i=s(588537),r=s(970028),n=s(418458),a=s(270617),o=s(911905),l=s(624635);function h(e){return!e.groupId&&!e.isHidden&&e.id!==l.RangeDependentStudyInputNames.FirstBar&&e.id!==l.RangeDependentStudyInputNames.LastBar}var d=s(214318);const u=(0,o.getLogger)("Platform.GUI.PropertyDialog.Indicators.MetaInfo");class c{constructor(e){this._metaInfo=e}hasUserEditableInputs(){return this._metaInfo.inputs.some(h)}getUserEditableInputs(){return this._metaInfo.inputs.filter(h)}hasUserEditableProperties(){return r.StudyMetaInfo.isScriptStrategy(this._metaInfo)}hasUserEditableStyles(){const e=this._metaInfo;return e.plots.length>0||void 0!==e.bands||void 0!==e.filledAreas||(0,d.isCustomStudy)(e.shortId)||r.StudyMetaInfo.isScriptStrategy(this._metaInfo)||Object.values(e.graphics).some((e=>void 0!==e))}
getUserEditablePlots(){const e=new Set,t=this._metaInfo;return t.plots.filter((s=>{if((0,n.isColorerPlot)(s)||(0,n.isTextColorerPlot)(s)||(0,n.isDataOffsetPlot)(s)||(0,n.isOhlcColorerPlot)(s)||(0,n.isAlertConditionPlot)(s)||(0,n.isDataPlot)(s))return!1;if((0,n.isOhlcPlot)(s)){const r=s.target;if(e.has(r))return!1;e.add(r);const n=(0,i.ensureDefined)(t.ohlcPlots);return!(0,i.ensureDefined)(n[r]).isHidden}{const e=t.styles?t.styles[s.id]:void 0;return void 0===e||!e.isHidden}}))}hasUserEditableOptions(){return this.hasUserEditableInputs()||this.hasUserEditableProperties()||this.hasUserEditableStyles()}getStrategyProperties(){const e=this._metaInfo,t=e.inputs.filter(p),s={..._};for(const i of t){const t=i.internalID;s[t]=i,_.hasOwnProperty(t)||u.logWarn(`Unknown strategy input internal id ${t} in ${e.fullId}`)}return(0,a.clone)(s)}}const _={currency:void 0,backtest_fill_limits_assumption:void 0,calc_on_every_tick:void 0,calc_on_order_fills:void 0,commission_value:void 0,commission_type:void 0,initial_capital:void 0,pyramiding:void 0,slippage:void 0,default_qty_type:void 0,default_qty_value:void 0,margin_long:void 0,margin_short:void 0,use_bar_magnifier:void 0,process_orders_on_close:void 0};function p(e){return"strategy_props"===e.groupId}},912904:(e,t,s)=>{s.d(t,{MarketStatusModel:()=>c});var i=s(588537),r=s(262325),n=s.n(r),a=s(797753),o=s(393987),l=s(749473);class h{constructor(e,t){this._utcTime=new(n())(null),this._expired=new(n())(!1),this._sessionSpec=new(n())(null),this._sessionSpecCache=null,this._utcDayStart=new Date(0),this._timeoutId=null,this._expiredBySymbolInfoTypespecs=!1,this._expiredByQuotesTypespecs=null,this._marketStatusSpawn=e.spawn(),this._quotesUpdate=t,this._quotesUpdate.subscribe(this,this._onQuotesUpdate)}destroy(){this._marketStatusSpawn.destroy(),this._clearTimeoutIfNeeded(),this._quotesUpdate.unsubscribeAll(this)}reset(){this._expiredBySymbolInfoTypespecs=!1,this._expiredByQuotesTypespecs=null,this._utcTime.setValue(null),this._expired.setValue(!1)}utcTime(){return this._utcTime.readonly()}expired(){return this._expired.readonly()}utcDayStart(){return this._utcDayStart}sessionSpec(){return this._sessionSpec.readonly()}setSymbolInfo(e){var t;if(this._clearTimeoutIfNeeded(),null===e||!(0,l.isFuturesContractSymbol)(e)||void 0===e.expiration)return this._utcTime.setValue(null),void this._expired.setValue(!1);null!==this._sessionSpecCache&&this._sessionSpecCache.timezone===e.timezone&&this._sessionSpecCache.session===e.session&&this._sessionSpecCache.corrections===e.corrections&&this._sessionSpecCache.holidays===e.session_holidays||(this._sessionSpecCache={timezone:e.timezone,session:e.session,corrections:e.corrections,holidays:e.session_holidays,spec:new a.SessionSpec(e.timezone,e.session,e.session_holidays,e.corrections)},this._sessionSpec.setValue(null));const s=this._sessionSpecCache.spec;this._utcDayStart=function(e){const t=Math.floor(e/1e4)%1e4,s=Math.floor(e/100)%100-1,i=e%100;return new Date(Date.UTC(t,s,i))}(e.expiration);const i=s.bordersOfDailyBar(this._utcDayStart)
;if(null===i)return this._utcTime.setValue(null),this._expired.setValue(!1),void this._sessionSpec.setValue(s);const r=(0,o.get_timezone)(e.timezone);this._utcTime.setValue((0,o.cal_to_utc)(r,i.to)+1e3),this._sessionSpec.setValue(s),this._expiredBySymbolInfoTypespecs=Boolean(null===(t=e.typespecs)||void 0===t?void 0:t.includes("expired")),this._updateExpired()}_updateExpired(){this._clearTimeoutIfNeeded();const e=this._utcTime.value();if(null===e)return;if(this._expiredByQuotesTypespecs||this._expiredBySymbolInfoTypespecs)return void this._expired.setValue(!0);const t=1e3*window.ChartApiInstance.serverTimeOffset()+Date.now();let s;switch(this._marketStatusSpawn.value()){case"out_of_session":case"holiday":s=e-3e5-t;break;case"market":case"pre_market":case"post_market":s=e+3e5-t;break;default:s=e-t}s>0&&(this._timeoutId=setTimeout((()=>this._updateExpired()),s)),this._expired.setValue(s<=0)}_clearTimeoutIfNeeded(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}_onQuotesUpdate(e,t){var s,i;let r=!1;if(null===this._expiredByQuotesTypespecs)this._expiredByQuotesTypespecs=Boolean(null===(s=e.values.typespecs)||void 0===s?void 0:s.includes("expired")),r=this._expiredByQuotesTypespecs;else if(void 0!==t.values.typespecs){const e=Boolean(null===(i=t.values.typespecs)||void 0===i?void 0:i.includes("expired"));r=this._expiredByQuotesTypespecs!==e,this._expiredByQuotesTypespecs=e}r&&null!==this._utcTime.value()&&this._updateExpired()}}function d(){const e=window.ChartApiInstance.serverTimeOffset();return Date.now()/1e3+e}function u(e,t,s){return e<=s?t<=s?1/0:t/1e3:Math.min(e,t)/1e3}class c{constructor(e,t){this._marketStatus=new(n())(null),this._lastMarketStatus=null,this._sessionsSpec=null,this._nextSessionEdgeInternal=null,this._nextSessionEdge=new(n())(null),this._recalcNextSessionEdgeTimerId=null,this._futuresContractExpirationTime=null,this._quotesProvider=e,e.quotesUpdate().subscribe(this,this._update.bind(this)),this._futuresContractExpirationTime=new h(this._marketStatus.readonly(),e.quotesUpdate()),e.quoteSymbolChanged().subscribe(this,(()=>{(0,i.ensureNotNull)(this._futuresContractExpirationTime).reset(),this._nextSessionEdgeInternal=null,this._recalculateNextSessionEdge()})),this._resetSubscription=t,this._resetSubscription.subscribe(this,this._resetStatus)}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.quoteSymbolChanged().unsubscribeAll(this),this._resetSubscription.unsubscribeAll(this),null!==this._recalcNextSessionEdgeTimerId&&clearTimeout(this._recalcNextSessionEdgeTimerId),(0,i.ensureNotNull)(this._futuresContractExpirationTime).destroy()}futuresContractExpirationTime(){return this._futuresContractExpirationTime}setSymbolInfo(e){var t,s,r,n,o;if((0,i.ensureNotNull)(this._futuresContractExpirationTime).setSymbolInfo(e),this._nextSessionEdgeInternal=null,null===e)return void(this._sessionsSpec=null);const l=new a.SessionSpec(e.timezone,null!==(t=e.session_display)&&void 0!==t?t:e.session,e.session_holidays,e.corrections);let h,d
;const u=null===(s=e.subsessions)||void 0===s?void 0:s.find((e=>"premarket"===e.id)),c=null===(r=e.subsessions)||void 0===r?void 0:r.find((e=>"postmarket"===e.id));void 0!==u&&(h=new a.SessionSpec(e.timezone,null!==(n=u["session-display"])&&void 0!==n?n:u.session,e.session_holidays,u["session-correction"])),void 0!==c&&(d=new a.SessionSpec(e.timezone,null!==(o=c["session-display"])&&void 0!==o?o:c.session,e.session_holidays,c["session-correction"])),this._sessionsSpec={general:l,preMarket:h,postMarket:d},this._recalculateNextSessionEdge()}status(){return this._marketStatus}nextSessionEdge(){return this._nextSessionEdge}_resetStatus(){this._marketStatus.setValue(null)}_update(e){void 0!==e&&void 0!==e.values.current_session&&(this._lastMarketStatus=e.values.current_session),null!==this._lastMarketStatus?this._marketStatus.setValue(this._lastMarketStatus):this._resetStatus()}_getNextSessionEdgeInternal(){var e;if(null===this._sessionsSpec||"24x7"===this._sessionsSpec.general.spec())return null;const t=1e3*d();if(null===this._nextSessionEdgeInternal||(null!==(e=this._nextSessionEdgeInternal.timestamp)&&void 0!==e?e:1/0)<=t/1e3){const{general:e,preMarket:s,postMarket:i}=this._sessionsSpec,r=(0,o.get_timezone)(e.timezone()),n=(0,o.utc_to_cal)(r,t),a=u((0,o.cal_to_utc)(r,e.alignToNearestSessionStart(n,1)),(0,o.cal_to_utc)(r,e.alignToNearestSessionEnd(n,1)),t),l=u(void 0!==s?(0,o.cal_to_utc)(r,s.alignToNearestSessionStart(n,1)):1/0,void 0!==s?(0,o.cal_to_utc)(r,s.alignToNearestSessionEnd(n,1)):1/0,t),h=u(void 0!==i?(0,o.cal_to_utc)(r,i.alignToNearestSessionStart(n,1)):1/0,void 0!==i?(0,o.cal_to_utc)(r,i.alignToNearestSessionEnd(n,1)):1/0,t),d=Math.min(a,l,h);d===1/0&&(this._nextSessionEdgeInternal={timestamp:null}),this._nextSessionEdgeInternal=d===h?{timestamp:d,status:"post_market"}:d===l?{timestamp:d,status:"pre_market"}:{timestamp:d}}return this._nextSessionEdgeInternal}_recalculateNextSessionEdge(){const e=this._getNextSessionEdgeInternal();if(null===e||null===e.timestamp)return void this._nextSessionEdge.setValue(null);const t={status:e.status,remainingSeconds:Math.max(0,e.timestamp-d())};if(null===this._recalcNextSessionEdgeTimerId){let e=Math.ceil(t.remainingSeconds%60);0===e&&(e+=60),this._recalcNextSessionEdgeTimerId=setTimeout((()=>this._recalculateNextSessionEdgeByTimer()),1e3*e)}this._nextSessionEdge.setValue(t)}_recalculateNextSessionEdgeByTimer(){this._recalcNextSessionEdgeTimerId=null,this._recalculateNextSessionEdge()}}},281967:(e,t,s)=>{s.d(t,{DELAY_WITHOUT_AGREEMENT:()=>c,isBats:()=>_,firstReplacedByBatsExchange:()=>p,isEod:()=>m,isYield:()=>S,isDelay:()=>b,witoutRealtime:()=>y,isTickByTick:()=>g,isDelayForGuest:()=>v,isDelayWithoutMarketAgreement:()=>f,getExchange:()=>w});var i=s(588537),r=s(166437),n=s.n(r),a=s(833813),o=s(560507),l=s(195048),h=s(749473);const d=["DJ","CBOE","JSE"],u=["NZX"],c=["ICESG"];function _(e){return n().hasBatsSymbols(e.full_name)}function p(e){const t=n().getExchanges(e.pro_name),s=n().getExchanges(e.full_name)
;for(let e=0;e<s.length;++e)if("BATS"===s[e].toUpperCase())return t[e];return null}function m(e,t){return n().hasEodSymbols(e.full_name)||t===l.STATUS_EOD}function S(e){var t;return Boolean(null===(t=e.typespecs)||void 0===t?void 0:t.includes("yield"))}function b(e){return void 0!==e&&e>0}function y(e){return"index"===e.type&&d.includes(e.listed_exchange)||"futures"===e.type&&u.includes(e.listed_exchange)}function g(e,t){return!((0,o.enabled)(a.ProductFeatures.TICK_BY_TICK_PUSH_DATA)||b(e.delay)||m(e,t)||(0,h.isCryptoSymbol)(e))}function v(e,t){return t.listed_exchange===e&&!window.is_authenticated}function f(e){return c.includes(e.listed_exchange)}async function w(e){{const t=(0,i.ensureDefined)(window.pro);await new Promise((e=>{t.runOrUpdate(e)}));const s=t.getProduct(function(e){return`exchange-${e.pro_perm}`}(e)),r=function(e){let t;if(!window.pro)throw new Error("Pro module not defined");t=window.pro.getProductsByType(window.pro.PRODUCT_TYPES.exchange).find((t=>Boolean(t.included_exchanges&&t.included_exchanges.includes(e))));return t||null}(s.exchange||"");return r&&"cme-full"===r.exchange?s:r||s}}},110933:(e,t,s)=>{s.d(t,{tradingService:()=>n,waitTradingService:()=>a});var i=s(564894);const r={id:"TradingService"};function n(){return(0,i.hasService)(r)?(0,i.service)(r):null}function a(){return(0,i.waitServiceRegistered)(r)}},453765:(e,t,s)=>{s.d(t,{extrapolateBarsFrontToTime:()=>r,extrapolateBarsFrontByCount:()=>n});var i=s(370062);function r(e,t,s,i,n=!1){if(t>s){const a=r(e,s,t,i,n);return a.count=-a.count,a}return a(e,t,1,((e,t)=>t>s||0!==i&&e>i),n)}function n(e,t,s,i=!1){const r=s<0?-1:1;return a(e,t,r,((e,t)=>e>=s*r),i)}function a(e,t,s,r,n){let a=0,o=t;e.moveTo(o);let l=0,h=Number.MAX_VALUE,d=!1,u=t;const c=[];for(;!r(a,o);){if(l>15)throw new Error("Internal error 0x10 while extrapolating.");const r=e.indexOfBar(o);if(r===i.SessionStage.PRE_SESSION&&1===s)o=e.startOfBar(0),e.moveTo(o);else if(r===i.SessionStage.PRE_SESSION&&-1===s)o=e.startOfBar(i.SessionStage.PRE_SESSION),e.moveTo(o);else if(r===i.SessionStage.POST_SESSION&&1===s)o=e.startOfBar(i.SessionStage.POST_SESSION),e.moveTo(o);else{if(r===i.SessionStage.POST_SESSION&&-1===s)throw new Error("Internal error 0x12 while extrapolating.");{const _=e.startOfBar(r);if(_>t&&s>0||t>_&&s<0){if(d&&h===_)throw new Error("Internal error 0x11 while extrapolating.");d=!0,h=_,l=0,a++,u=_,n&&c.push(u)}if(0===r&&-1===s)o=_-1;else{o=e.startOfBar(r+s);const t=e.startOfBar(i.SessionStage.POST_SESSION);o>t&&(e.moveTo(t),o=e.startOfBar(0))}}}l++}return{time:u,times:c,count:a}}},612826:(e,t,s)=>{s.d(t,{BarsRange:()=>r});var i=s(588537);class r{constructor(e,t){(0,i.assert)(e<=t,"The last bar in the bars range should be greater than or equal to the first bar"),this._firstBar=e,this._lastBar=t}firstBar(){return this._firstBar}lastBar(){return this._lastBar}count(){return this._lastBar-this._firstBar+1}contains(e){return this._firstBar<=e&&e<=this._lastBar}equals(e){return this._firstBar===e.firstBar()&&this._lastBar===e.lastBar()}static compare(e,t){
return null===e||null===t?e===t:e.equals(t)}}},381269:(e,t,s)=>{s.d(t,{customFormatters:()=>i});const i={dateFormatter:null,timeFormatter:null,tickMarkFormatter:null,priceFormatterFactory:null}},830318:(e,t,s)=>{s.d(t,{monthFormatFunction:()=>m,dateFormatFunctions:()=>S,getDateFormatWithWeekday:()=>b,availableDateFormats:()=>y,defaultDateFormat:()=>g});var i=s(575932),r=s(39654),n=s(796347);const a={1:()=>(0,i.t)("Jan"),2:()=>(0,i.t)("Feb"),3:()=>(0,i.t)("Mar"),4:()=>(0,i.t)("Apr"),5:()=>(0,i.t)("May",{context:"short"}),6:()=>(0,i.t)("Jun"),7:()=>(0,i.t)("Jul"),8:()=>(0,i.t)("Aug"),9:()=>(0,i.t)("Sep"),10:()=>(0,i.t)("Oct"),11:()=>(0,i.t)("Nov"),12:()=>(0,i.t)("Dec")},o=(e,t)=>(t?e.getMonth():e.getUTCMonth())+1,l=(e,t)=>t?e.getFullYear():e.getUTCFullYear(),h=e=>e.toLocaleDateString(window.language?(0,r.getIsoLanguageCodeFromLanguage)(window.language):void 0,{weekday:"short",timeZone:"UTC"}),d=(e,t)=>(0,n.numberToStringWithLeadingZero)(((e,t)=>t?e.getDate():e.getUTCDate())(e,t),2),u=(e,t)=>a[o(e,t)](),c=(e,t)=>(0,n.numberToStringWithLeadingZero)(o(e,t),2),_=(e,t)=>(0,n.numberToStringWithLeadingZero)(l(e,t)%100,2),p=(e,t)=>(0,n.numberToStringWithLeadingZero)(l(e,t),4),m=(e,t)=>u(e,t),S={"dd MMM 'yy":(e,t)=>`${d(e,t)} ${u(e,t)} '${_(e,t)}`,"MMM dd, yyyy":(e,t)=>`${u(e,t)} ${d(e,t)}, ${p(e,t)}`,"MMM dd":(e,t)=>`${u(e,t)} ${d(e,t)}`,"dd MMM":(e,t)=>`${d(e,t)} ${u(e,t)}`,"yyyy-MM-dd":(e,t)=>`${p(e,t)}-${c(e,t)}-${d(e,t)}`,"yy-MM-dd":(e,t)=>`${_(e,t)}-${c(e,t)}-${d(e,t)}`,"yy/MM/dd":(e,t)=>`${_(e,t)}/${c(e,t)}/${d(e,t)}`,"yyyy/MM/dd":(e,t)=>`${p(e,t)}/${c(e,t)}/${d(e,t)}`,"dd-MM-yyyy":(e,t)=>`${d(e,t)}-${c(e,t)}-${p(e,t)}`,"dd-MM-yy":(e,t)=>`${d(e,t)}-${c(e,t)}-${_(e,t)}`,"dd/MM/yy":(e,t)=>`${d(e,t)}/${c(e,t)}/${_(e,t)}`,"dd/MM/yyyy":(e,t)=>`${d(e,t)}/${c(e,t)}/${p(e,t)}`,"MM/dd/yy":(e,t)=>`${c(e,t)}/${d(e,t)}/${_(e,t)}`,"MM/dd/yyyy":(e,t)=>`${c(e,t)}/${d(e,t)}/${p(e,t)}`};function b(e){return"ja"===window.language?(t,s)=>`${S[e](t,s)} (${h(t)})`:(t,s)=>`${h(t)} ${S[e](t,s)}`}const y=Object.keys(S),g=()=>-1!==["ja","ko","zh","zh_TW"].indexOf(window.language||"")?"yyyy-MM-dd":"dd MMM 'yy"},504122:(e,t,s)=>{s.d(t,{DateFormatter:()=>n});var i=s(381269),r=s(830318);class n{constructor(e="yyyy-MM-dd",t=!1){this._dateFormatFunc=t?(0,r.getDateFormatWithWeekday)(e):r.dateFormatFunctions[e]}format(e){return i.customFormatters&&i.customFormatters.dateFormatter?i.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!1)}formatLocal(e){return i.customFormatters.dateFormatter?i.customFormatters.dateFormatter.formatLocal?i.customFormatters.dateFormatter.formatLocal(e):i.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!0)}}},820187:(e,t,s)=>{s.d(t,{hourMinuteSecondFormat:()=>n,hourMinuteSecondMilisecFormat:()=>a,hourMinuteFormat:()=>o,twelveHourMinuteSecondFormat:()=>l,twelveHourMinuteFormat:()=>h,TimeFormatter:()=>d});var i=s(381269),r=s(796347);const n="%h:%m:%s",a="%h:%m:%s.%ss",o="%h:%m",l="%h:%m:%s %ampm",h="%h:%m %ampm";class d{constructor(e){this._isTwelveHoursFormat=!1,this._formatStr=e||n,
this._isTwelveHoursFormat=this._formatStr.includes("%ampm")}format(e){return i.customFormatters.timeFormatter?i.customFormatters.timeFormatter.format(e):this._formatTime(e,!1)}formatLocal(e){return i.customFormatters.timeFormatter?i.customFormatters.timeFormatter.formatLocal?i.customFormatters.timeFormatter.formatLocal(e):i.customFormatters.timeFormatter.format(e):this._formatTime(e,!0)}_formatTime(e,t){let s=t?e.getHours():e.getUTCHours();const i=t?e.getMinutes():e.getUTCMinutes(),n=t?e.getSeconds():e.getUTCSeconds(),a=t?e.getMilliseconds():e.getUTCMilliseconds();let o="";return this._isTwelveHoursFormat&&(o=s>=12?"PM":"AM",s%=12,s=s||12),this._formatStr.replace("%h",(0,r.numberToStringWithLeadingZero)(s,2)).replace("%m",(0,r.numberToStringWithLeadingZero)(i,2)).replace("%s",(0,r.numberToStringWithLeadingZero)(n,2)).replace("%ss",(0,r.numberToStringWithLeadingZero)(a,3)).replace("%ampm",o)}}},850979:(e,t,s)=>{s.d(t,{FutureBarsPaneView:()=>l});var i=s(588537),r=s(380047),n=s(103653);const a={0:{background:"rgba(255, 158, 171, 0.3)",line:"#7E202F"},1:{background:"rgba(244, 255, 158, 0.3)",line:"#EBFF3F"},2:{background:"rgba(195, 255, 160, 0.3)",line:"#308020"}};class o extends r.ScaledPaneRenderer{constructor(){super(...arguments),this._data=null}setData(e){this._data=e}hitTest(){return null}_drawImpl(e,t){if(null===this._data)return;const s=a[this._data.predictionCode];e.fillStyle=s.background,e.fillRect(Math.max(0,this._data.startX),0,t.cssWidth,t.cssHeight),e.strokeStyle=s.line,e.beginPath(),e.lineWidth=1;const i=Math.round(this._data.startX);e.moveTo(i,0),e.lineTo(i,t.cssHeight),e.stroke()}}class l{constructor(e,t,s,i){this._renderer=new o,this._startX=0,this._series=t,this._timeScale=e,this._lastKnownBarIndex=s,this._direction=i}update(){this._startX=this._timeScale.indexToCoordinate(this._lastKnownBarIndex)+.5*this._timeScale.barSpacing()+1}renderer(){const e=(0,n.barFunction)("close"),t=this._series.data().bars(),s=e((0,i.ensureNotNull)(t.valueAt(this._lastKnownBarIndex))),r=e((0,i.ensureNotNull)(t.last()).value);let a=0;r>s?a=1:r<s&&(a=2);let o=1;return 0!==this._direction&&(o=this._direction===a?2:0),this._renderer.setData({startX:this._startX,predictionCode:o}),this._renderer}}},91110:(e,t,s)=>{function i(e){return e?["AMEX"].includes(e)?"Arca":["NYSE ARCA & MKT"].includes(e)?"NYSE Arca":e:""}s.d(t,{redefineExchangeName:()=>i})},468369:(e,t,s)=>{s.d(t,{SeriesBase:()=>ns});var i=s(588537),r=s(638456),n=s(345848),a=s(251954),o=s(911905),l=s(902899),h=s(103653),d=s(752280),u=s(559270),c=s(232567),_=s.n(c),p=s(749473),m=s(796347),S=s(195048),b=s(892139),y=s(575932),g=s(611688),v=s(913324),f=s(5073),w=s(902105),P=s(91110);const C=(0,y.t)("Symbol Error"),x=(0,r.onWidget)(),I=g.enabled("hide_unresolved_symbols_in_legend");class T extends f.StatusProviderBase{constructor(e,t,s,i){super(t),this._series=e,this._statusViewProperties=s,this._options=i||{}}text(){return(0,w.generateTitleForGui)(this._getTitleGenerationOptions())}getSplitTitle(){return(0,w.generateSplitTitleForGui)(this._getTitleGenerationOptions())}
bold(){return!1}size(){return this._statusViewProperties.childs().fontSize.value()+"px"}errorStatus(){const e=this._series.seriesErrorMessage();return null!==e?{error:e,title:C}:null}_getTitleGenerationOptions(){var e,t;const s=this._series.symbolInfo(),i=this._statusViewProperties.childs(),r=this._series.symbolTextSourceProxyProperty().value();let n;if(i.showExchange.value()&&s){const i=(0,p.isEconomicSymbol)(s)&&(null!==(t=null===(e=s.source2)||void 0===e?void 0:e.description)&&void 0!==t?t:s.source);n=i||(x||"forex"===s.type?s.exchange:(0,P.redefineExchangeName)(null==s?void 0:s.listed_exchange))}return{description:"ticker"===r?s&&s.name||void 0:(0,v.getTranslatedSymbolDescription)({pro_name:s&&s.pro_name||void 0,short_name:s&&s.name||void 0,description:s&&s.description||void 0,short_description:s&&s.short_description||void 0,local_description:s&&s.local_description||void 0,language:s&&s.language||void 0}),exchange:n,symbol:I&&null===s?"":this._series.symbol(),interval:i.showInterval.value()&&!this._options.hideResolution?this._series.interval():void 0,style:this._series.properties().childs().style.value(),inputs:this._series.getInputsProperties().state(),boxSize:this._series.data().boxSize,reversalAmount:this._series.data().reversalAmount,ticker:"ticker-and-description"===r?s&&s.name||void 0:"",branding:this._options.branding}}}class V extends b.StatusView{constructor(e,t,s,i){super(new T(e,t,s,i)),this._invalidated=!0,this._series=e,this._series.onRestarted().subscribe(this,this.update),this._series.dataEvents().symbolResolved().subscribe(this,this.update),this._series.dataEvents().completed().subscribe(this,this.update),this._series.boxSizeValue().subscribe(this.update.bind(this)),s.childs().symbolTextSource.listeners().subscribe(this,this.update)}getSeriesPrecision(){let e=4;const t=this._series.symbolInfo();return t&&t.pricescale&&(e=Math.round(Math.log(t.pricescale)/Math.log(10))),e}round(e){const t=this.getSeriesPrecision(),s=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return s?s.toString():""}update(){this._invalidated=!0}text(){return this._updateImpl(),super.text()}color(){return this._updateImpl(),super.color()}bold(){return this._updateImpl(),super.bold()}size(){return this._updateImpl(),super.size()}getSplitTitle(){return this._updateImpl(),this._statusProvider.getSplitTitle()}_updateImpl(){this._invalidated&&(this._bold=this._statusProvider.bold(),this._size=this._statusProvider.size(),this._text=this._statusProvider.text(),this._invalidated=!1)}}var A=s(734906),M=s(773547),R=s(308170),D=s(394683),E=s(540968);const B=r.CheckMobile.any(),L=g.enabled("hide_resolution_in_legend");class k extends A.DataWindowView{constructor(e,t){super(),this._invalidated=!0,this._series=e,this._model=t,this._valuesProvider=this._createValuesProvider(e,t),this._items=this._valuesProvider.getItems().map((e=>new A.DataWindowItem(e.id,e.title,"",e.unimportant))),this.update()}update(){this._invalidated=!0}items(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items}series(){return this._series}
_updateImpl(){const e=this._series.symbolInfo();if(e){const t=[e.name];L||t.push((0,M.translatedIntervalString)(this._series.interval())),(0,p.isEconomicSymbol)(e)&&e.source?t.push(e.source):t.push((0,r.onWidget)()||"forex"===e.type?e.exchange:e.listed_exchange),this._header=t.join(", "),this._title=e.description}else this._header=this._series.symbol();const t=this._model.crossHairSource().appliedIndex(),s=this._valuesProvider.getValues(t);for(let e=0;e<s.length;++e){const t=s[e],i=this._items[e];i.setValue(t.value),i.setVisible(t.visible),i.setColor(t.color)}}_createValuesProvider(e,t){return new D.SeriesValuesProvider(e,t)}_showLastPriceAndChangeOnly(){return B&&(null===this._model.crossHairSource().pane||(0,E.isLineToolName)(R.tool.value())||null!==this._model.lineBeingEdited())}}const F={open:(0,y.t)("O",{context:"in_legend"}),high:(0,y.t)("H",{context:"in_legend"}),low:(0,y.t)("L",{context:"in_legend"}),close:(0,y.t)("C",{context:"in_legend"}),hl2:(0,y.t)("HL2",{context:"in_legend"}),hlc3:(0,y.t)("HLC3",{context:"in_legend"}),ohlc4:(0,y.t)("OHLC4",{context:"in_legend"})};class N extends D.SeriesValuesProvider{constructor(e,t){super(e,t);const s=t.properties().childs().paneProperties.childs().legendProperties.childs();this._showBarChange=s.showBarChange,this._showSeriesOHLC=s.showSeriesOHLC,this._showVolume=s.showVolume,this._seriesStyle=e.properties().childs().style;const i=this._emptyValues[0],r=this._emptyValues[1],n=this._emptyValues[2];i.title=F.open,r.title=F.high,n.title=F.low,i.unimportant=!0,r.unimportant=!0,n.unimportant=!0,this._emptyValues[3].title=F.close,this._emptyValues[6].title="",this._emptyValues[4].title=""}getValues(e){const t=super.getValues(e),s=this._showSeriesOHLC.value(),i=this._showBarChange.value(),r=12===this._series.style(),n=t[6];n.visible=n.visible&&i&&!r;const a=t[7];if(a.visible=a.visible&&this._showVolume.value(),this._showLastPriceAndChangeOnly()){const e=t[5];return e.visible=e.visible&&s,t}const o=(0,p.isPriceSourceStyle)(this._seriesStyle.value()),l=s&&!o,h=s&&o;return t[0].visible=l&&!r,t[1].visible=l,t[2].visible=l,t[3].visible=l&&!r,t[4].visible=h,t}}var O=s(214729);const U=(0,y.t)("At close");class W extends k{constructor(e,t){super(e,t),this._backgroundColorSpawn=t.backgroundTopColor().spawn(),this._backgroundColorSpawn.subscribe(this.update.bind(this));const s=t.properties().childs().paneProperties.childs().legendProperties.childs();this._visibilityProperty=(0,O.combineProperty)(((e,t,s)=>e||t||s),s.showBarChange,s.showSeriesOHLC,s.showVolume),this._visibilityProperty.subscribe(this,this.update)}areValuesVisible(){return this._visibilityProperty.value()}additional(){const e=this._series.dataPoweredBy();return null!==e&&e.length>0?(0,y.t)("Data Provided by")+" "+e:null}marketTitle(){const e=this._series.marketStatusModel().status().value();return this._showLastPriceAndChangeOnly()&&("pre_market"===e||"post_market"===e)?`${U}:`:""}destroy(){this._backgroundColorSpawn.destroy(),this._visibilityProperty.destroy()}_createValuesProvider(e,t){return new N(e,t)}}
var H=s(912904),j=s(38627),z=s(273044),q=s(566190),$=s(453765),G=s(95935);let Y=0;class Z{constructor(e,t){this._extrapolatedData=[],this._cacheForFuture=!1,this._modelId=Y++,this._builderCache=null,this._uniqueId=(0,G.randomHashN)(6),this._resolution=t,this._symbolInfo=e,this._valid=Boolean(e.timezone)&&Boolean(e.session),this._session=new q.SessionInfo(e.timezone,e.session,e.session_holidays,e.corrections)}syncSourceTarget(){return{uniqueId:this._uniqueId,resolution:this._resolution,symbolInfo:this._symbolInfo,session:this._session.state()}}getSymbolInfo(){return this._symbolInfo}getSession(){return this._session}getResolution(){return this._resolution}uniqueId(){return this._modelId}distance(e,t){if(!this.isValid())return{success:!1};if(e>t)return{success:!1};if(e===t)return{success:!0,result:0};let s=this._extrapolatedData.length,i=0!==s?this._extrapolatedData[0]:null,r=null!==i?this._extrapolatedData[s-1]:null;const n=e<t;if(1e3*e===i&&this._cacheForFuture===n||(this._extrapolatedData=[1e3*e],s=1,i=null,r=null),null===i||null!==r&&1e3*t>r){const i=(0,$.extrapolateBarsFrontToTime)(this._barBuilder(),r||1e3*e,1e3*t,2e3,!0);this._extrapolatedData=this._extrapolatedData.concat(i.times),s=this._extrapolatedData.length,this._cacheForFuture=n}if(r=this._extrapolatedData[s-1],r<1e3*t)return{success:!1};const a=this._extrapolatedData.indexOf(1e3*t);return-1===a?{success:!1}:{success:!0,result:a}}projectTime(e,t){if(!this.isValid())return e;let s=this._extrapolatedData.length,i=s>0?this._extrapolatedData[0]:null,r=null!==i?this._extrapolatedData[s-1]:null;const n=t>=0;1e3*e===i&&this._cacheForFuture===n||(this._extrapolatedData=[1e3*e],s=1,i=null,r=null);const a=Math.abs(t);if(null===i||a>=s){const i=(0,$.extrapolateBarsFrontByCount)(this._barBuilder(),r||1e3*e,Math.sign(t)*(a-s+1),!0);this._extrapolatedData=this._extrapolatedData.concat(i.times),s=this._extrapolatedData.length,this._cacheForFuture=n}return s<a?e:this._extrapolatedData[a]/1e3}isValid(){return this._valid}dataSize(){return this._extrapolatedData.length}createNewModelWithResolution(e){return new Z(this._symbolInfo,e)}_barBuilder(){return null===this._builderCache&&(this._builderCache=(0,q.newBarBuilder)(this._resolution,this._session,this._session)),this._builderCache}}var X=s(262325),Q=s.n(X),J=s(841926),K=s(281967),ee=s(99177);const te=(0,o.getLogger)("Chart.Definitions.Series");function se(e,t){return"TickByTick"===e?{mode:e,updatePeriod:t}:{mode:e}}function ie(e,t,s){const i=[];return(0,K.isDelay)(e.delay)?function(e){const t=[];return(0,K.witoutRealtime)(e)?t.push(se("DelayNoRealtime")):(0,K.isDelayForGuest)("MOEX",e)?t.push(se("MOEXDelayForGuest")):(0,K.isDelayForGuest)("TFEX",e)?t.push(se("TFEXDelayForGuest")):(0,K.isDelayForGuest)("CHIXAU",e)?t.push(se("CHIXAuDelayForGuest")):(0,K.isDelayForGuest)("NGM",e)?t.push(se("NGMDelayForGuest")):(0,K.isDelayForGuest)("ICESG",e)?t.push(se("ICESGDelayForGuest")):(0,K.isDelayForGuest)("ADX",e)?t.push(se("ADXDelayForGuest")):(0,
K.isDelayForGuest)("TRADEGATE",e)?t.push(se("TRADEGATEDelayForGuest")):["BER","DUS","HAM","HAN","MUN"].some((t=>(0,K.isDelayForGuest)(t,e)))?t.push(se("DEForGuest")):["MIL"].some((t=>(0,K.isDelayForGuest)(t,e)))?t.push(se("MILDelayForGuest")):(0,K.isDelayWithoutMarketAgreement)(e)?t.push(se("DelayWithoutMarketAgreement")):t.push(se("DelayToRealtime")),t}(e):(0,K.isEod)(e,t)?(i.push(se("EOD")),i):((0,K.isTickByTick)(e,t)&&0!==s&&i.push(se("TickByTick",s)),(0,K.isBats)(e)&&i.push(se("BATSToRealtime")),i)}class re{constructor(e,t,s,i){this._dataUpdatedInfoStatus=new(Q())(null),this._symbolInfo=(0,J.createWVFromGetterAndSubscription)(e.getter,e.onChange),this._status=(0,J.createWVFromGetterAndSubscription)(t.getter,t.onChange),this._updatePeriod=(0,J.createWVFromGetterAndSubscription)(s.getter,s.onChange),this._symbolInfo.subscribe(this._update.bind(this)),this._status.subscribe(this._update.bind(this)),this._updatePeriod.subscribe(this._update.bind(this)),this._resetSubscription=i,this._resetSubscription.subscribe(this,this._resetStatus)}destroy(){this._symbolInfo.destroy(),this._status.destroy(),this._updatePeriod.destroy(),this._resetSubscription.unsubscribeAll(this)}status(){return this._dataUpdatedInfoStatus.readonly()}symbolName(){const e=this._symbolInfo.value();return null!==e?e.name:""}time(){const e=this._symbolInfo.value(),t=null!==e&&e.delay&&e.delay>0?e.delay:900;return Math.round(t/60)}listedExchange(){const e=this._symbolInfo.value();return null!==e?e.listed_exchange:""}async description(){const e=this._symbolInfo.value();if(null===e)return"";let t={};try{t=(0,i.ensureNotNull)(await(0,K.getExchange)(e))}catch(e){te.logWarn(`Cannot get exchange ${(0,ee.errorToString)(e)}`)}return t.description||e.listed_exchange}exchange(){const e=this._symbolInfo.value();return null!==e?e.exchange:""}proName(){const e=this._symbolInfo.value();return null!==e?e.pro_name:""}firstReplacedByBatsExchange(){const e=this._symbolInfo.value();return e&&(0,K.firstReplacedByBatsExchange)(e)}_resetStatus(){this._dataUpdatedInfoStatus.setValue(null)}_update(){const e=this._symbolInfo.value();if(null===e)return void this._dataUpdatedInfoStatus.setValue(null);const t=this._status.value();if("string"==typeof t)return void this._dataUpdatedInfoStatus.setValue(null);if(t===S.STATUS_LOADING||t===S.STATUS_RESOLVING)return;const s=ie(e,t,this._updatePeriod.value());0!==s.length?this._dataUpdatedInfoStatus.setValue(s):this._dataUpdatedInfoStatus.setValue(null)}}var ne=s(257380),ae=s(270617);class oe{constructor(e,t){this._dataProblem=new ne.WatchedObject(null),this._quotesProvider=e,this._quotesProvider.quotesUpdate().subscribe(this,this._update.bind(this)),this._resetSubscription=t,this._resetSubscription.subscribe(this,this._resetStatus)}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._resetSubscription.unsubscribeAll(this)}status(){return this._dataProblem}_resetStatus(){this._dataProblem.setValue(null)}_update(e){void 0===e.values||void 0===e.values.data_problem?this._resetStatus():this._dataProblem.setValue((0,
ae.clone)(e.values.data_problem))}}var le=s(556074),he=s(721386),de=s(498424),ue=s(926281),ce=s(393987);function _e(e){return e<10?`0${e}`:e.toString()}function pe(e,t=Date.now()/1e3){let s=Math.ceil(e-t);if(s<=0)return"";if(s<3600){const e=Math.floor(s/60),t=Math.ceil(s%60);return`${_e(e)}:${_e(t)}`}if(s<86400){const e=Math.floor(s/3600);s%=3600;const t=Math.floor(s/60);s%=60;const i=Math.ceil(s);return`${_e(e)}:${_e(t)}:${_e(i)}`}{const i=new Date(1e3*e),r=new Date(1e3*t),n=ce.get_year(i),a=ce.get_year(r),o=ce.get_month(i),l=ce.get_month(r),h=ce.get_day_of_month(r),d=me(i)-me(r)>=0?0:-1;let u=12*(n-a)+(o-l)+d;if(u>0){const t=ce.get_days_in_month(l,a);!function(e,t){const s=ce.get_day_of_month(e);e.setUTCMonth(ce.get_month(e)+t),ce.get_day_of_month(e)!==s&&e.setUTCDate(0)}(r,u);const s=ce.get_days_in_month(ce.get_month(r),ce.get_year(r)),i=h!==t&&s===ce.get_day_of_month(r)?t-h:0;let n=Math.ceil((e-r.getTime()/1e3)/86400)+i;return n>=s&&(u++,n=0),`${u}M ${n}d`}if(-1===d){if(ce.get_days_in_month(l,a)-s/86400<1/24)return"1M 0d"}let c=Math.floor(s/86400);s%=86400;let _=Math.ceil(s/3600);return 24===_&&(_=0,c+=1),c===ce.get_days_in_month(o,n)?"1M 0d":`${c}d ${_}h`}}function me(e){return 86400*e.getUTCDate()+3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()}var Se=s(943615),be=s(194459);const ye=[0,1,2,3,9,8,10],ge=g.enabled("force_exchange_as_title"),ve={alwaysShowGlobalLast:!1,visibleOnHistoryOnly:!1,showCountdown:!0,showSymbolLabel:!0,useSolidBodyColor:!0};class fe extends de.PriceAxisView{constructor(e,t,s){super(),this._previousCountdown="",this._source=e,this._model=t,this._options={...ve,...s}}updateCountdown(){this._countdownText()!==this._previousCountdown&&(this.update((0,be.sourceChangeEvent)(this._source.id())),this._model.updateSourcePriceScale(this._source))}_getSource(){return this._source}_getModel(){return this._model}_isCountdownEnabled(){return this._options.showCountdown}_countdownText(){{const e=this._source.barCloseTime();return null===e?"":pe(e,this._currentTime()/1e3)}}_updateRendererData(e,t,s){var r;if(e.visible=!1,t.visible=!1,!this._source.isVisible())return;const n=this._source.properties().childs();if(12===n.style.value())return;const a=this._model.timeScale().visibleBarsStrictRange(),o=this._source.data().last();if(null===a||null===o)return;if(this._options.visibleOnHistoryOnly&&a.contains(o.index))return;const l=this._model.properties().childs().scalesProperties.childs();let h=l.showSeriesLastValue.value(),d=this._isCountdownEnabled()&&-1!==ye.indexOf(n.style.value())&&n.showCountdown.value()&&(this._options.alwaysShowGlobalLast||a.contains(o.index)),u=this._options.showSymbolLabel&&l.showSymbolLabels.value();const c=l.seriesLastValueMode.value()===ue.PriceAxisLastValueMode.LastPriceAndPercentageValue,_=this._source.lastValueData(void 0,this._options.alwaysShowGlobalLast);if(_.noData)return;const p=8===n.style.value();if((h||d||u)&&p&&n.haStyle.childs().showRealLastPrice.value()){const e=this._source.lastValueData(void 0,!1),t=this._source.lastValueData(void 0,!0)
;e.noData||t.noData||e.index!==t.index||(h=!1,d=!1,u=!1)}const m=this._source.priceLineColor(_.color);if(this._options.useSolidBodyColor?(s.background=m,s.borderColor=void 0):(s.background=this._model.backgroundColorAtYPercentFromTop((null!==(r=s.fixedCoordinate)&&void 0!==r?r:s.coordinate)/(0,i.ensureNotNull)(this._model.paneForSource(this._source)).height()),s.borderColor=m),s.coordinate=_.coordinate,s.floatCoordinate=_.floatCoordinate,h||d){const t=this._axisFirstLineText(_,h);e.text=t,this._options.useSolidBodyColor?(s.textColor=this.generateTextColor(s.background),e.borderVisible=!1):(e.borderVisible=!0,s.textColor=m),e.textColor=s.textColor;const i=h&&c?(0,Se.getOppositeModePriceText)(this._source.priceScale(),_):"";e.secondLine=i,s.secondLineTextColor=s.textColor;const r=d?this._countdownText():"";this._previousCountdown=r,e.thirdLine=r,s.thirdLineTextColor=(0,he.generateColor)(s.textColor,25),0===t.length&&0===i.length&&0===r.length||(e.visible=!0)}u&&(t.text=this._paneText(u),t.visible=t.text.length>0)}_paneText(e){let t="";const s=this._source.symbolInfo();return ge?t=(0,p.displayedSymbolExchange)(s):e&&(t=(0,p.displayedSymbolName)(s)),t}_axisFirstLineText(e,t){return t?(0,Se.getCurrentModePriceText)(this._source.priceScale(),e):""}_currentTime(){return Date.now()+1e3*this._source.serverTimeOffset()}}var we=s(736643),Pe=s(175203),Ce=s(290557),xe=s(362145),Ie=s(647527),Te=s(270369);class Ve extends de.PriceAxisView{constructor(e,t){super(),this._source=e,this._model=t}_updateRendererData(e,t,s){e.visible=!1;const i=this._source;if(!this._model.properties().childs().scalesProperties.childs().showSeriesPrevCloseValue.value())return;if(i.isDWM())return;const r=i.prevClose();if(null===r)return;const n=this._source.properties().childs().prevClosePriceLineColor.value();s.background=n,s.textColor=this.generateTextColor(n),s.coordinate=r.coordinate,e.text=(0,Se.getCurrentModePriceText)(i.priceScale(),r),e.visible=!0}}var Ae=s(406059),Me=s(345185);class Re extends Ae.SeriesHorizontalLinePaneView{constructor(e){super(e),this._lineRendererData.linestyle=Me.LINESTYLE_DOTTED}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.properties().childs();if(!e.showPrevClosePriceLine.value())return;if(this._series.isDWM())return;const t=this._series.prevClose();null!==t&&(this._lineRendererData.visible=!0,this._lineRendererData.y=t.coordinate,this._lineRendererData.color=e.prevClosePriceLineColor.value(),this._lineRendererData.linewidth=e.prevClosePriceLineWidth.value())}}var De=s(207152),Ee=s(203308),Be=s(86441),Le=s(346037),ke=s(218718);class Fe{constructor(e,t){this._bars=[],this._invalidated=!0,this._isMarkersEnabled=(0,g.enabled)("source_selection_markers"),this._selectionData=null,this._blockSize=0,this._series=e,this._model=t,this._selectionIndexer=new Le.SelectionIndexes(t.timeScale())}update(){this._invalidated=!0}nearestIndex(e,t){var s,i;return null!==(i=null===(s=this.bars().search(e,t))||void 0===s?void 0:s.index)&&void 0!==i?i:null}items(){return this._bars}_updateImpl(){if(this._bars=[],
6===this._series.properties().childs().style.value()&&!this._series.data().boxSize)return;const e=this._series.priceScale(),t=this._model.timeScale();if(t.isEmpty()||!e||e.isEmpty())return;const s=this._series.getRealVisibleRange();if(null===s)return;if(0===this.bars().size())return;if(this._series.data().bars().isEmpty())return;let r=s.firstBar();const n=s.lastBar(),a=this._series.firstValue();if(null===a)return;for(;r<=n;r++){if(null!==this.bars().valueAt(r))break}if(r>n)return;const o=this.bars().range(r,n),l=this._series.barColorer(),h={},d=this._series.properties().childs().style.value(),u=5===d||6===d,c=this.isProjection(),_=(0,i.ensureNotNull)(this.bars().lastIndex()),p=6===d?(0,i.ensureDefined)(this._series.data().boxSize):0;if(o.each(((e,t)=>{const s=t[1],i=t[2],r=t[3],n=t[4];if(void 0===s||void 0===i||void 0===r||void 0===n||null===s||null===i||null===r||null===n)return!1;h.value=t;const a=l.barStyle(e,c,h),o=u?t[6]:void 0,m={time:Math.round(e),open:s,high:i,low:r,close:n,color:a.barColor,borderColor:a.barBorderColor,isUp:a.isBarUp};switch(h.previousValue=t,d){case 6:m.low-=.5*p,m.high+=.5*p,m.upColor=a.upColor,m.downColor=a.downColor,m.isMergedBar=a.isMergedBar,m.additionalNum=Math.round(1+(i-r)/p);break;case 5:if(m.upColor=a.upColor,m.downColor=a.downColor,m.isTwoColorBar=a.isTwoColorBar,!(0,Ee.default)(o))break;m.additionalPrice=o,c&&m.time===_&&(m.combinedWithProjection=!0)}return this._bars.push(m),!1})),6===d&&(this._blockSize=(e.priceToCoordinate(0,a)-e.priceToCoordinate(500,a))/500*p),e.barPricesToCoordinates(this._bars,a),t.barIndexesToCoordinates(this._bars),this._model.selection().isSelected(this._series)){const s=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0,barSpacing:t.barSpacing(),hittestResult:ke.HitTestResult.REGULAR};const r=(0,i.ensureNotNull)(this._model.paneForSource(this._series)).height();this._selectionData.hittestResult=ke.HitTestResult.REGULAR;for(let i=0;i<s.length;i++){const n=s[i],o=this._series.bars().valueAt(n);if(null===o)continue;const l=o[1],h=o[4];if(null==l||null==h)continue;const d=.5*(l+h),u=t.indexToCoordinate(n),c=e.priceToCoordinate(d,a);this._selectionData.points.push(new Be.Point(u,c)),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(c/r))}}else this._selectionIndexer.clear()}}class Ne extends Fe{bars(){return this._series.bars()}isProjection(){return!1}}class Oe extends Fe{bars(){return this._series.nsBars()}isProjection(){return!0}}class Ue extends Oe{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s=this._series.properties().childs(),i={bars:this._bars,barSpacing:this._model.timeScale().barSpacing(),thinBars:s.rangeStyle.childs().thinBars.value(),dontDrawOpen:s.barStyle.childs().dontDrawOpen.value()};return new De.PaneRendererBars(i)}}var We=s(267850);class He extends fe{lastPrice(){return this._getSource().data().lastProjectionPrice}_updateRendererData(e,t,s){e.visible=!1,t.visible=!1
;const r=this._getModel(),n=this._getSource(),a=n.priceScale(),o=r.timeScale(),l=this.lastPrice();if(o.isEmpty()||a.isEmpty()||void 0===l)return;const h=o.visibleBarsStrictRange();if(null===h)return;const u=h.firstBar(),c=h.lastBar(),_=n.data(),p=_.search(c,d.PlotRowSearchMode.NearestLeft);if(null===p)return;const m=n.nearestIndex(u,d.PlotRowSearchMode.NearestRight);if(void 0===m)return;const S=n.model().properties().childs().scalesProperties.childs(),b=(0,i.ensureNotNull)(_.valueAt(m))[4];let y=s.background,g=S.showSeriesLastValue.value(),v=!1,f=!1,w=!1;const P=n.lastValueData(4,!1),C=n.properties().childs();if(8===C.style.value()&&C.haStyle.childs().showRealLastPrice.value()){const e=n.lastValueData(4,!0);if(e.noData||e.color===s.background||(y=e.color),!e.noData&&!P.noData){const t=e.index===P.index;v=t&&S.showSymbolLabels.value(),f=S.seriesLastValueMode.value()===ue.PriceAxisLastValueMode.LastPriceAndPercentageValue,g=g&&t,w=t&&this._isCountdownEnabled()&&C.showCountdown.value()}}else{y=n.barColorer().barStyle(p.index,!0).barColor}if(s.background=y,s.textColor=this.generateTextColor(y),s.secondLineTextColor=s.textColor,s.thirdLineTextColor=(0,he.generateColor)(s.textColor,25),s.coordinate=a.priceToCoordinate(l,b),e.visible=g||w,!P.noData){const s=n.priceScale().isPercentage();P.formattedPriceAbsolute=a.formatPriceAbsolute(l),P.formattedPricePercentage=a.formatPricePercentage(l,b,!0),P.text=s?P.formattedPricePercentage:P.formattedPriceAbsolute,e.text=this._axisFirstLineText(P,g),e.secondLine=g&&f?s?P.formattedPriceAbsolute:P.formattedPricePercentage:"",e.thirdLine=w?this._countdownText():"",t.text=this._paneText(v)}t.visible=v}}var je=s(613648),ze=s(350985),qe=s(391055);const $e={light:{lineStyle:Me.LINESTYLE_DOTTED,lineWidth:1,textColor:qe.colorsPalette["color-cold-gray-900"],backgroundColor:qe.colorsPalette["color-tv-blue-50"],lineColor:qe.colorsPalette["color-cold-gray-500"]},dark:{lineStyle:Me.LINESTYLE_DOTTED,lineWidth:1,textColor:qe.colorsPalette["color-white"],backgroundColor:qe.colorsPalette["color-tv-blue-a800"],lineColor:qe.colorsPalette["color-cold-gray-500"]}};function Ge(e){return e?$e.dark:$e.light}class Ye extends ze.HorizontalLinePaneView{constructor(e,t,s){super(),this._model=e,this._isVisible=t.lineVisible,this._lineColor=t.lineColor,this._lineWidth=t.lineWidth,this._getValue=s}_updateImpl(){const e=this._lineRendererData;if(e.visible=!1,!this._isVisible.value())return;const t=this._model.mainSeries(),s=t.priceScale(),i=t.firstValue(),r=this._getValue();if(null===i||null===r)return;const n=Ge(this._model.isDark()),a=this._lineColor.value()?this._lineColor.value():n.lineColor,o=this._lineWidth.value()?this._lineWidth.value():n.lineWidth;e.visible=!0,e.y=s.priceToCoordinate(r,i),e.linestyle=n.lineStyle,e.linewidth=o,e.color=a}}class Ze extends de.PriceAxisView{constructor(e,t,s,i){super(),this._model=e,this._label=t,this._isVisible=s,this._getValue=i}_updateRendererData(e,t,s){if(e.visible=!1,t.visible=!1,!this._isVisible.value())return
;const i=this._model.mainSeries(),r=i.priceScale(),n=i.firstValue(),a=this._getValue();if(null===n||null===a)return;const o=Ge(this._model.isDark());e.visible=!0,t.visible=!0,e.text=r.formatPriceAbsolute(a),t.text=this._label,s.coordinate=r.priceToCoordinate(a,n),s.background=o.backgroundColor,s.textColor=o.textColor}}class Xe extends We.PriceLineAxisView{constructor(e,t,s){super(),this._model=e,this._isLineVisible=t,this._getValue=s}_isVisible(){return this._isLineVisible.value()}_lineWidth(){return Ge(this._model.isDark()).lineWidth}_lineStyle(){return Ge(this._model.isDark()).lineStyle}_priceLineColor(e){return Ge(this._model.isDark()).lineColor}_value(){const e=this._model.mainSeries(),t=e.priceScale(),s=e.firstValue(),i=this._getValue();if(null===s||null===i)return{noData:!0};const r=t.priceToCoordinate(i,s);return{noData:!1,floatCoordinate:r,coordinate:r,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",formattedPriceIndexedTo100:"",text:"",index:0}}}const Qe=(0,y.t)("High"),Je=(0,y.t)("Low");function Ke(e,t,s,i){const r=new Ye(e,s,i),n=new Ze(e,s.label,s.labelVisible,i);return{paneView:r,panePriceAxisView:new je.PanePriceAxisView(n,t,e),priceAxisView:n,priceLineAxisView:new Xe(e,s.lineVisible,i)}}var et=s(97639),tt=s.n(et),st=s(706342),it=s(15693);class rt{constructor(){this._data=null}setData(e){this._data=e}data(){return this._data}draw(e,t){const s=this._data;if(null===s)return;const i=t.pixelRatio;e.save();const r=Math.max(1,Math.floor(i)),n=r%2/2,a=Math.round(s.center.x*i)+n,o=s.center.y*i;e.fillStyle=s.seriesLineColor,e.beginPath();const l=Math.max(2,1.5*s.seriesLineWidth)*i;e.arc(a,o,l,0,2*Math.PI,!1),e.fill(),e.fillStyle=s.fillColor,e.beginPath(),e.arc(a,o,s.radius*i,0,2*Math.PI,!1),e.fill(),e.lineWidth=r,e.strokeStyle=s.strokeColor,e.beginPath(),e.arc(a,o,s.radius*i+r/2,0,2*Math.PI,!1),e.stroke(),e.restore()}hitTest(e,t){return null}}function nt(e){return e}const at=[{start:0,end:.25,startRadius:4,endRadius:10,startFillAlpha:.25,endFillAlpha:0,startStrokeAlpha:.4,endStrokeAlpha:.8,easing:nt},{start:.25,end:.525,startRadius:10,endRadius:14,startFillAlpha:0,endFillAlpha:0,startStrokeAlpha:.8,endStrokeAlpha:0,easing:nt},{start:.525,end:1,startRadius:14,endRadius:14,startFillAlpha:0,endFillAlpha:0,startStrokeAlpha:0,endStrokeAlpha:0,easing:nt}];function ot(e,t,s,i){const r=s+(i-s)*t;return(0,he.applyTransparency)(e,(0,he.alphaToTransparency)(r))}function lt(e,t){const s=e%2600/2600;let i;for(const e of at)if(s>=e.start&&s<=e.end){i=e;break}if(void 0===i)throw new Error("Last price animation internal logic error");const r=i.easing((s-i.start)/(i.end-i.start));return{fillColor:ot(t,r,i.startFillAlpha,i.endFillAlpha),strokeColor:ot(t,r,i.startStrokeAlpha,i.endStrokeAlpha),radius:(n=r,a=i.startRadius,o=i.endRadius,a+(o-a)*n)};var n,a,o}class ht{constructor(e){this._renderer=new rt,this._invalidated=!0,this._stageInvalidated=!0,this._startTime=performance.now(),this._endTime=this._startTime-1,this._series=e}update(e){if(this._invalidated=!0,
"data-source-change"===e.type&&e.sourceId===this._series.id()&&e.realtime&&this._series.seriesLoaded()){const e=performance.now(),t=this._endTime-e;if(t>0)return void(t<650&&(this._endTime+=2600));this._startTime=e,this._endTime=e+2600}}invalidateStage(){this._stageInvalidated=!0}animationActive(){return performance.now()<=this._endTime}stopAnimation(){this._endTime=this._startTime-1}renderer(e,t){return this._invalidated?(this._updateImpl(e,t),this._invalidated=!1,this._stageInvalidated=!1):this._stageInvalidated&&(this._updateRendererDataStage(),this._stageInvalidated=!1),this._renderer}_updateImpl(e,t){this._renderer.setData(null);const s=this._series.model().timeScale(),i=s.visibleBarsStrictRange(),r=this._series.firstValue(),n=this._series.lastValueData(void 0,!0,!0);if(null===i||null===r||void 0===n.index||void 0===n.price||!i.contains(n.index))return;const a=new Be.Point(s.indexToCoordinate(n.index),this._series.priceScale().priceToCoordinate(n.price,r)),o=n.color,l=this._series.properties().childs();let h;switch(this._series.style()){case 3:h=l.areaStyle.childs().linewidth.value();break;case 10:const t=l.baselineStyle,s=Math.round(e*(Math.abs(100-t.childs().baseLevelPercentage.value())/100));h=a.y<=s?t.childs().topLineWidth.value():t.childs().bottomLineWidth.value();break;default:h=l.lineStyle.childs().linewidth.value()}const d=lt(this._duration(),o);this._renderer.setData({seriesLineColor:o,seriesLineWidth:h,fillColor:d.fillColor,strokeColor:d.strokeColor,radius:d.radius,center:a})}_updateRendererDataStage(){const e=this._renderer.data();if(null!==e){const t=lt(this._duration(),e.seriesLineColor);e.fillColor=t.fillColor,e.strokeColor=t.strokeColor,e.radius=t.radius}}_duration(){return this.animationActive()?performance.now()-this._startTime:2599}}var dt=s(388230),ut=s(180372),ct=s(908803),_t=s(364019);class pt extends Ae.SeriesHorizontalLinePaneView{constructor(e){super(e),this._lineRendererData.linestyle=Me.LINESTYLE_DOTTED}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.properties().childs();if(!e.showPriceLine.value())return;if(12===e.style.value())return;const t=this._series.lastValueData(void 0,!0);t.noData||(this._lineRendererData.visible=!0,this._lineRendererData.y=t.coordinate,this._lineRendererData.color=this._series.priceLineColor(t.color),this._lineRendererData.linewidth=e.priceLineWidth.value())}}var mt=s(156776),St=s(30347),bt=s(717611),yt=s(859447),gt=s(601132),vt=s(544077);class ft extends vt.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barWidth=e.barSpacing}draw(e,t){e.save();const s=Math.round(t.pixelRatio*this._barWidth/2);let i=null;for(let r=0;r<this._bars.length;++r){const n=this._bars[r],a=Math.round(n.time*t.pixelRatio),o=null===i?Math.round(a-s):i+1,l=(r<this._bars.length-1?Math.round(this._bars[r+1].time*t.pixelRatio):a+2*s)-s-o,h=Math.round(Math.min(n.close,n.open)*t.pixelRatio),d=Math.round(Math.max(n.close,n.open)*t.pixelRatio)-h+1;e.fillStyle=n.borderColor,e.fillRect(o,h,l,d),
e.fillRect(a,Math.round(n.high*t.pixelRatio),1,Math.round((n.low-n.high)*t.pixelRatio)),e.fillStyle=n.color,e.fillRect(o+1,h+1,l-2,d-2),i=o+l-1}e.restore()}_getTolerance(){return(0,gt.interactionTolerance)().series+.5}_getBarSpacing(){return this._barWidth}}class wt extends Ne{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()},i=new bt.CompositeRenderer;return i.append(new ft(s)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&i.append(new yt.SelectionRenderer(this._selectionData)),i}}class Pt extends Oe{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()};return new ft(s)}}class Ct extends Ne{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:.9*this._model.timeScale().barSpacing()},i=new bt.CompositeRenderer;return i.append(new ft(s)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&i.append(new yt.SelectionRenderer(this._selectionData)),i}}class xt extends Oe{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:.9*this._model.timeScale().barSpacing()};return new ft(s)}}class It extends vt.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._barLineWidth=Math.max(1,(0,gt.optimalBarWidth)(e.barSpacing,1))}draw(e,t){let s,i,r;e.save(),e.lineCap="square";const n=Math.floor(t.pixelRatio)%2?1:0;for(const a of this._bars){const o=Math.round(t.pixelRatio*this._barLineWidth*.5),l=Math.round(t.pixelRatio*a.time-o),h=void 0===i||a.isUp?Math.round(t.pixelRatio*a.high-o):i,d=2*o;let u;if(a.isTwoColorBar){const i=Math.round(t.pixelRatio*a.additionalPrice-t.pixelRatio*a.high+o),r=h+i,c=Math.round(t.pixelRatio*a.low-t.pixelRatio*a.additionalPrice+o),_=void 0!==s&&a.isUp?s:r+c;e.fillStyle=a.upColor,e.fillRect(l,h,d+n,i),e.fillStyle=a.downColor,e.fillRect(l,r,d+n,_+o-r+1),u=_}else{const i=Math.round(t.pixelRatio*a.low-t.pixelRatio*a.high+o),r=void 0!==s&&a.isUp?s:h+i;e.fillStyle=a.color,e.fillRect(l,h,d+n,r+o-h+1),u=r}if(!a.combinedWithProjection){a.isTwoColorBar?e.fillStyle=a.isUp?a.downColor:a.upColor:e.fillStyle=a.color;const s=void 0===r?Math.round((a.time-this._barSpacing)*t.pixelRatio+o):r+2*o,l=Math.round(a.time*t.pixelRatio-o)-s+1,h=2*o+n;if(a.isUp)e.fillRect(s,u-o+1-n,l,h);else{const r=void 0===i?Math.round(a.open*t.pixelRatio-o):i;e.fillRect(s,r,l,h)}}r=l,s=u,i=h}e.restore()}_getTolerance(){return(0,gt.interactionTolerance)().series+this._barLineWidth/4}_getBarSpacing(){return this._barLineWidth}}class Tt extends Ne{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()},i=new bt.CompositeRenderer;return i.append(new It(s)),
this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&i.append(new yt.SelectionRenderer(this._selectionData)),i}}class Vt extends Oe{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()};return new It(s)}}var At;!function(e){e[e.EllipseWidth=.9]="EllipseWidth",e[e.EllipseRadius=.95]="EllipseRadius",e[e.SimplifiedEllipseWidth=.86]="SimplifiedEllipseWidth"}(At||(At={}));class Mt extends vt.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._barWidth=e.barSpacing}draw(e,t){if(0===this._bars.length)return;e.save();const s=this._bars.reduce(((e,t)=>Math.max(e,(t.low-t.high)/t.additionalNum)),0);this._barSpacing>1&&s>=1?this._drawFillSigns(e,t):this._drawSimplified(e,t),e.restore()}_drawImpl(e){}_getTolerance(){return(0,gt.interactionTolerance)().series+this._barWidth/8}_getBarSpacing(){return this._barSpacing}_drawBarCross(e,t,s,i){!function(e,t,s,i,r){e.moveTo(t,s),e.lineTo(t+i,s+r),e.moveTo(t+i,s),e.lineTo(t,s+r)}(e,t.time-.5*this._barWidth,t.high+i*s,this._barWidth,s)}_drawBarEllipse(e,t,s,i){!function(e,t,s,i,r){e.save(),e.translate(t+i/2,s+r/2),e.scale(i/2,r/2),e.moveTo(1,0),e.arc(0,0,At.EllipseRadius,0,2*Math.PI,!1),e.restore()}(e,t.time-this._barWidth*At.EllipseWidth*.5,t.high+i*s,this._barWidth*At.EllipseWidth,s)}_drawFillSigns(e,t){e.scale(t.pixelRatio,t.pixelRatio),e.lineCap="butt",e.lineWidth=1;for(const t of this._bars){const s=(t.low-t.high)/t.additionalNum;if(t.isMergedBar&&(e.beginPath(),t.isUp?this._drawBarEllipse(e,t,s,t.additionalNum-1):this._drawBarCross(e,t,s,0),e.strokeStyle=t.isUp?t.downColor:t.upColor,e.stroke()),e.beginPath(),t.isUp)for(let i=t.additionalNum-1-(t.isMergedBar?1:0);i>-1;i--)this._drawBarCross(e,t,s,i);else for(let i=t.isMergedBar?1:0;i<t.additionalNum;i++)this._drawBarEllipse(e,t,s,i);e.strokeStyle=t.color,e.stroke()}}_drawSimplified(e,t){for(const s of this._bars){const i=s.isUp?1:At.SimplifiedEllipseWidth,r=(s.time-.5*this._barWidth*i)*t.pixelRatio,n=(s.time+.5*this._barWidth*i)*t.pixelRatio,a=Math.max(1,n-r);let o=s.high*t.pixelRatio;const l=s.low*t.pixelRatio,h=s.high*t.pixelRatio;let d=Math.max(1,l-h);if(s.isMergedBar){e.fillStyle=s.isUp?s.downColor:s.upColor;const t=(s.low-s.high)/s.additionalNum,i=Math.max(1,Math.round(t));s.isUp?(e.fillRect(r,o,a,i),o+=i):(e.fillRect(r,o+a-i,a,i),d-=i)}e.fillStyle=s.color,e.fillRect(r,o,a,d)}}}class Rt extends Ne{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()},i=new bt.CompositeRenderer;return i.append(new Mt(s)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&i.append(new yt.SelectionRenderer(this._selectionData)),i}}class Dt extends Oe{renderer(e,t){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const s={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()};return new Mt(s)}}
var Et=s(612826),Bt=s(514628),Lt=s(837778),kt=s(38080),Ft=s(142426),Nt=s(328057),Ot=s(280446);class Ut extends kt.SeriesCandlesPaneView{renderer(e,t){this._invalidated&&(this._updateImpl(null),this._invalidated=!1);const s=this._source.priceScale();if(!s)return null;const i=this._source.properties().childs().haStyle.childs(),r=this._model.timeScale().barSpacing(),n={bars:this._bars,barSpacing:r,bodyVisible:i.drawBody.value(),borderVisible:i.drawBorder.value(),borderColor:i.borderColor.value(),wickColor:i.wickColor.value(),barWidth:(0,gt.optimalBarWidth)(r),wickVisible:i.drawWick.value(),isPriceScaleInverted:s.isInverted()},a=new bt.CompositeRenderer;return a.append(new Ot.PaneRendererCandles(n)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&a.append(new yt.SelectionRenderer(this._selectionData)),a}}var Wt=s(487765),Ht=s(870914),jt=s(895405),zt=s(289627),qt=s(400353);s(381269);const $t=g.enabled("price_scale_always_last_bar_value"),Gt=g.enabled("display_data_mode"),Yt=r.CheckMobile.any(),Zt=!(0,r.onWidget)(),Xt=!g.enabled("hide_series_legend_item"),Qt=g.enabled("hide_price_scale_global_last_bar_value"),Jt=g.enabled("alerts"),Kt=g.enabled("no_bars_status"),es=g.enabled("charting_library_debug_mode"),ts=(0,o.getLogger)("Chart.Series");let ss=!1;const is={countdownEnabled:!0,lastPriceAnimationEnabled:!0};function rs(e,t,s){return void 0===t?null:`${e}=${t} (${s?"changed":"unchanged"})`}class ns extends l.PriceDataSource{constructor(e,t,r,n){super(e,"_seriesId"),this.chartWidgetInitialized=new(tt()),this.requestingIntradayWhenNotSupported=new(tt()),this.requestingResolutionWhenNotSupported=new(tt()),this.requestingStyleIsNotSupported=new(tt()),this.requestingStyleSupportRecovered=new(tt()),this.requestingResolutionLessThanFrequency=new(tt()),this._paneView=null,this._futureBarsPaneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=null,this._gotoDateView=null,this._baseHorizontalLineView=null,this._priceStep=null,this._symbolInfo=null,this._prevSymbolInfo=null,this._isPrePostMarketPricesAvailableProperty=new(_())(!1),this._isBackAdjustmentForbiddenProperty=new(_())(!0),this._isSettlementAsCloseForbiddenProperty=new(_())(!0),this._highLowPriceCache=new Map,this._averagePriceCache=new Map,this._prevClosePriceAxisView=null,this._priceScaleChanged=new(tt()),this._priceScaleAboutToBeChanged=new(tt()),this._onRestarted=new(tt()),this._onStatusChanged=new(tt()),this._extendedHoursChanged=new(tt()),this._tagsChanged=new(tt()),this._intervalChanged=new(tt()),this._sessionIdChanged=new(tt()),this._requestMoreDataAvailable=!0,this._lineStyleLastPriceCirclePaneView=new ht(this),this._prevClosePriceLineView=null,this._dataPoweredBy=null,this._loading=!0,this._seriesLoaded=!1,this._status=0,this._symbolResolvingActive=new(Q())(!1),this._predictBars=0,this._syncModel=null,this._data=null,this._lastCompleteFlags=null,this._haStyle={studyId:(0,i.ensureNotNull)((0,p.chartStyleStudyId)(8,!0))},this._renkoStyle={studyId:(0,i.ensureNotNull)((0,
p.chartStyleStudyId)(4,!0))},this._pbStyle={studyId:(0,i.ensureNotNull)((0,p.chartStyleStudyId)(7,!0))},this._kagiStyle={studyId:(0,i.ensureNotNull)((0,p.chartStyleStudyId)(5,!0))},this._pnfStyle={studyId:(0,i.ensureNotNull)((0,p.chartStyleStudyId)(6,!0))},this._rangeStyle={studyId:(0,i.ensureNotNull)((0,p.chartStyleStudyId)(11,!0))},this._barColorerCache=null,this._boxSizeValue=new(Q()),this._base=100,this._pointValue=1,this._formattingDeps=null,this._formatter=new m.PriceFormatter(this._base),this._ignoreMinMoveFormatter=new m.PriceFormatter(this._base),this._ignoreMinMovePriceStep=null,this._lastBarCloseTime=null,this._onSessionIdPropertyChangedBound=this._onSessionIdPropertyChanged.bind(this),this._ignoreSessionIdProxyPropertyChanges=!1,this._textSourceIsAlwaysTickerRestrictionEnabled=!1,this._lastPriceAnimationActive=!1,this._currentSession="out_of_session",this._onStyleChanged=new(tt()),this._intervalObj=null,this._obsoleteZOrder=0,this._seriesErrorMessage=null,this._seriesAlwaysFalseHibernatedVW=new(Q())(!1),this._styleToRecover=null,this._precomputedBarStyles=new WeakMap,this._doNotShowLastAvailableBar=!1,this._gotoDateResultCleared=!1,this._endOfDataPaneView=null,this._pendingTimeRange=null,this._replaySubscriber=null,this._symbolIntervalChanged=new(tt()),this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged=new(tt()),this._replayExitedDueUnsupportedInterval=new(tt()),this._replayExitedDueUnavailableForUserInterval=new(tt()),this._onTimeFrameApplied=new(tt()),this._prevRequestedInterval="",this._isActingAsSymbolSource=new(Q())(!0),this._seriesSource=new ut.SeriesDataSource(e.chartApi(),"s",n);const a=this._seriesSource.dataEvents();a.symbolResolved().subscribe(this,this._onSymbolResolved),a.symbolError().subscribe(this,this._onSymbolError),a.seriesTimeFrame().subscribe(this,this._onSeriesTimeFrame),a.seriesError().subscribe(this,this._onSeriesError),a.loading().subscribe(this,this._onSeriesLoading),a.completed().subscribe(this,this._onSeriesCompleted),a.dataUpdated().subscribe(this,this._onDataUpdated),a.barReceived().subscribe(this,this._onBarReceived),this._quotesProvider=new le.QuotesProvider,this._quotesProvider.quotesUpdate().subscribe(this,this._onQuotesUpdate);const o=t.childs();if(t.hasChild("extendedHours")){(0,i.ensureDefined)(o.extendedHours).value()&&!t.hasChild("sessionId")&&t.addChild("sessionId",new(_())("extended")),t.removeProperty("extendedHours")}t.hasChild("sessionId")||t.addChild("sessionId",new(_())("regular")),this._setProperties(t),this._sessionIdProxyProperty=new(_())(o.sessionId.value()),o.sessionId.subscribe(this,(()=>this._updateSessionIdProxyProperty())),this._sessionIdProxyProperty.subscribe(this,this._onSessionIdProxyPropertyChanged),this._symbolTextSourceProxyProperty=new(_()),this._recalcSymbolTextSourceProxyProperty(),o.statusViewStyle.childs().symbolTextSource.subscribe(this,this._recalcSymbolTextSourceProxyProperty),this._symbolTextSourceProxyProperty.subscribe(this,(()=>e.lightUpdate())),this._options=(0,ae.merge)((0,ae.clone)(is),r),
this._prevChartStyle=o.style.value(),this._priceAxisView=new fe(this,e,{alwaysShowGlobalLast:!Qt,showCountdown:r.countdownEnabled});let l=null;$t||Qt||(l=new fe(this,e,{visibleOnHistoryOnly:!0,showSymbolLabel:!1,showCountdown:!1,alwaysShowGlobalLast:!1,useSolidBodyColor:!1})),this._priceLinePriceAxisView=new We.SeriesPriceLineAxisView(this),this._priceLineAxisViews=[this._priceLinePriceAxisView];const h=new He(this,e,{showCountdown:r.countdownEnabled});this._priceAxisViews=[this._priceAxisView,h],null!==l&&this._priceAxisViews.push(l),this._prevClosePriceAxisView=new Ve(this,e),this._priceAxisViews.unshift(this._prevClosePriceAxisView),this._prevClosePriceLineView=new Re(this),this._panePriceAxisView=new je.PanePriceAxisView(this._priceAxisView,this,e),this._historyPricePanePriceAxisView=null!==l?new je.PanePriceAxisView(l,this,e):null,this._projectionPriceAxisView=new je.PanePriceAxisView(h,this,e),this._labelPaneViews=[this._panePriceAxisView,this._projectionPriceAxisView],null!==this._historyPricePanePriceAxisView&&this._labelPaneViews.push(this._historyPricePanePriceAxisView),this._highLowAvgPaneViews=[],this._averagePaneViews=[],this._createHighLowAvgViews(),this._subscribeRestartToSessionIdChange(),o.visible.subscribe(this,this._updateLastPriceAnimationActive),this._updateLastPriceAnimationActive(),this._dataWindowView=new k(this,e),this._legendView=new W(this,e);const d={branding:Zt};this._statusView=new V(this,this._model.properties().childs().scalesProperties.childs().textColor,o.statusViewStyle,d),this._marketStatusModel=new H.MarketStatusModel(this._quotesProvider,o.symbol.listeners()),this._dataUpdatedModeModel=Gt?new re({getter:this.symbolInfo.bind(this),onChange:a.symbolResolved()},{getter:this.status.bind(this),onChange:this._onStatusChanged},{getter:()=>{var e;return null===(e=this._lastCompleteFlags)||void 0===e?void 0:e.rt_update_period},onChange:a.completed()},o.symbol.listeners()):null,this._dataProblemModel=new oe(this._quotesProvider,o.symbol.listeners()),o.backAdjustment.subscribe(this,(()=>{this.isStarted()&&this.restart()})),o.settlementAsClose.subscribe(this,(()=>{this.isDWM()&&this.isStarted()&&this.restart()})),this._symbolResolvingActive.subscribe((()=>e.realignLineTools())),this._intervalChanged.subscribe(this,(()=>e.realignLineTools())),g.enabled("widget")||Promise.all([s.e(90519),s.e(90926),s.e(10146),s.e(8834),s.e(30063),s.e(5979),s.e(55508),s.e(50307),s.e(87995),s.e(27582),s.e(66849)]).then(s.bind(s,881496)).then((e=>{this._endOfDataPaneView=new e.EndOfDataLollipopPaneView(this)})),this._symbolIntervalChanged.subscribe(this,this._checkInterval)}supportsPressedChunks(){return!0}pressedChunks(e,t){return this.data().pressedChunks(e,t)}seriesErrorMessage(){return this._seriesErrorMessage}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),this._model.timeScale().visibleBarsStrictRangeChanged().unsubscribeAll(this),this._unsubscribeRestartToSessionIdChange(),this._replayExitedDueUnsupportedInterval.destroy(),
this._replayExitedDueUnavailableForUserInterval.destroy(),this._onTimeFrameApplied.destroy()}isActingAsSymbolSource(){return this._isActingAsSymbolSource.readonly()}barColorer(){if(this._barColorerCache)return this._barColorerCache;let e=null;const t=this._model.dataSources();for(let s=t.length-1;s>=0;s--){const r=t[s];if((0,qt.isStudy)(r)&&r.hasBarColorer()&&!r.isSourceHidden()){const t=(0,i.ensureNotNull)(r.barColorer());null===e?e=t:e.pushBackBarColorer(t)}}return null===e?e=new zt.SeriesBarColorer(this):e.pushBackBarColorer(new zt.SeriesBarColorer(this)),this._barColorerCache=e,e}createPaneView(){this._paneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=this.hasClosePrice()?new pt(this):null;const e=this._properties.childs().style.value();switch(e){case 0:this._paneView=new Lt.SeriesBarsPaneView(this,this._model);break;case 1:this._paneView=new kt.SeriesCandlesPaneView(this,this._model);break;case 2:this._paneView=new Ft.SeriesLinePaneView(this,this._model);break;case 3:this._paneView=new Nt.SeriesAreaPaneView(this,this._model);break;case 8:this._paneView=new Ut(this,this._model);break;case 9:this._paneView=new Wt.SeriesHollowCandlesPaneView(this,this._model);break;case 13:this._paneView=new Bt.SeriesColumnsPaneView(this,this._model);break;case 10:{this._paneView=new Ht.SeriesBaselinePaneView(this,this._model);const e=this._properties.childs().baselineStyle.childs();this._waterlineView=new mt.SeriesWaterlinePaneView({paneHeight:()=>this.priceScale().height(),color:()=>e.baselineColor.value(),baseLevelPercentage:()=>e.baseLevelPercentage.value()});break}case 12:this._paneView=new St.SeriesHiLoPaneView(this,this._model)}switch(e){case 4:this._paneView=new wt(this,this._model),this._projectionBarsPaneView=new Pt(this,this._model);break;case 7:this._paneView=new Ct(this,this._model),this._projectionBarsPaneView=new xt(this,this._model);break;case 5:this._paneView=new Tt(this,this._model),this._projectionBarsPaneView=new Vt(this,this._model);break;case 6:this._paneView=new Rt(this,this._model),this._projectionBarsPaneView=new Dt(this,this._model)}if(11===e&&(this._paneView=new Lt.SeriesBarsPaneView(this,this._model),this._projectionBarsPaneView=new Ue(this,this._model)),null===this._paneView)throw Error("Unknown chart style assigned: "+e)}properties(){return this._properties}zorder(){return 0}quotesProvider(){return this._quotesProvider}currentSession(){return this._currentSession}getRealVisibleRange(){const e=this.model().timeScale().visibleBarsStrictRange();if(null===e)return null;const t=this.data().search(e.firstBar(),d.PlotRowSearchMode.NearestRight),s=this.data().search(e.lastBar(),d.PlotRowSearchMode.NearestLeft);return null===t||null===s?null:new Et.BarsRange(t.index,s.index)}syncModel(){if(!this._syncModel){const e=this.symbolInfo(),t=this.interval();if(!e||!t)return null;this._syncModel=new Z(e,t)}return this._syncModel}labelPaneViews(){return this._labelPaneViews}topPaneViews(){const e=[];if(null!==this._gotoDateView&&e.push(this._gotoDateView),
this._lastPriceAnimationActive){const t=this._lineStyleLastPriceCirclePaneView;t.animationActive()&&setTimeout((()=>this._model.invalidate(dt.InvalidationMask.cursor())),0),t.invalidateStage(),e.push(t)}return 0!==e.length?e:null}paneViews(){if(!this.properties().childs().visible.value())return null;const e=[(0,i.ensureNotNull)(this._baseHorizontalLineView),(0,i.ensureNotNull)(this._paneView)];return this._endOfDataPaneView&&e.push(this._endOfDataPaneView),this._futureBarsPaneView&&e.push(this._futureBarsPaneView),this._projectionBarsPaneView&&e.push(this._projectionBarsPaneView),null!==this._waterlineView&&e.push(this._waterlineView),e.push((0,i.ensureNotNull)(this._prevClosePriceLineView)),null!==this._priceLineView&&e.push(this._priceLineView),e.push(...this._highLowAvgPaneViews),e.push(...this._averagePaneViews),e}priceAxisViews(e,t){return e.findTargetPriceAxisViews(this,t,this._priceAxisViews,this._priceLineAxisViews)}clearHighLowPriceCache(){this._highLowPriceCache.clear()}clearAveragePriceCache(){this._averagePriceCache.clear()}priceScaleChanged(){return this._priceScaleChanged}priceScaleAboutToBeChanged(){return this._priceScaleAboutToBeChanged}disconnect(){this._seriesSource.stop(),this._predictBars=0,this._status=0,this._model.isSnapshot()||(this._prevSymbolInfo=null,this._symbolInfo=null)}isStarted(){return this._seriesSource.isStarted()}restart(e=!0){if(5===this._status)return;this._loading=!0,this._lastCompleteFlags=null,this._onRestarted.fire(),this._setStatus(1),this._updateSymbolInfo(null,e);let t=this._properties.childs().interval.value();z.Interval.isEqual(t,this._prevRequestedInterval)&&this._notifyIntervalChanged(t);let s=null;this._pendingTimeRange&&(s=this._pendingTimeRange,this._pendingTimeRange=null),this._removeReplaySubscriber(),this._onBeforeModifySeries(this.getSymbolString(),t),this._onTimeFrameApplied.fire(s),t=(0,_t.getServerInterval)(t),this._data=null,this._seriesSource.modifySeries(this._getResolvingSymbolObject(),t,s),this._seriesSource.isStarted()||this._seriesSource.start(),this._prevRequestedInterval=this.interval(),this.updateAllViews((0,be.sourceChangeEvent)(this.id())),this._model.lightUpdate()}isSymbolInvalid(){return 4===this._status}getSymbolString(){return(0,it.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject())}invalidateBarStylesCache(e){ts.logDebug("Invalidate style cache starting from "+e),this._clearStylePlot(this.bars(),e),this._clearStylePlot(this.nsBars())}isStatusBad(){return 12===this.status()||4===this.status()||10===this.status()}isStatusError(){return 12===this.status()}actualSymbol(){return(0,p.actualSymbol)(this.symbolInfo(),this.symbol())}proSymbol(){return(0,p.proSymbol)(this.symbolInfo(),this.symbol())}onStyleChanged(){return this._onStyleChanged}style(){return this.properties().childs().style.value()}setStyle(e){this.setSymbolParams({style:e})}isRangeBasedStyle(){return(0,p.isRangeBasedStyle)(this.style())}symbolSameAsCurrent(e){return(0,st.symbolSameAsCurrent)(e,this.symbolInfo())}status(){return this._status}symbol(){
return this.properties().childs().symbol.value()}symbolInfo(){return this._symbolInfo}symbolResolved(){return this.dataEvents().symbolResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._seriesAlwaysFalseHibernatedVW}firstValue(){const e=this.firstBar();return null===e?null:this._barFunction(e,0)}firstBar(){const e=this.model().timeScale().visibleBarsStrictRange();if(null===e)return null;const t=e.firstBar(),s=this.data().search(t,d.PlotRowSearchMode.NearestRight);return null!==s?s.value:null}formatter(e=!0){return e?this._formatter:this._ignoreMinMoveFormatter}priceStep(e=!0){return e?this._priceStep:this._ignoreMinMovePriceStep}bars(){return this.data().bars()}nsBars(){return this.data().nsBars()}interval(){return this.properties().childs().interval.value()}setInterval(e){this.setSymbolParams({interval:e})}intervalObj(){const e=this.interval();if(null!==this._intervalObj&&this._intervalObj.resolutionString===e)return this._intervalObj.interval;const t=z.Interval.parse(e);return this._intervalObj={resolutionString:e,interval:t},t}prevClose(){const e=this.priceScale();if(e.isEmpty()||this.data().isEmpty())return null;const t=this.quotes(),s=this.firstValue();if(null===t||null===s)return null;const i=t.prev_close_price;return void 0===i?null:{coordinate:e.priceToCoordinate(i,s),floatCoordinate:e.priceToCoordinate(i,s),formattedPricePercentage:e.formatPricePercentage(i,s,!0),formattedPriceAbsolute:e.formatPriceAbsolute(i),formattedPriceIndexedTo100:e.formatPriceIndexedTo100(i,s)}}hasClosePrice(){return 12!==this.properties().childs().style.value()}lastValueData(e,t,s){var i;const r={noData:!0},n=this.priceScale();if(this.model().timeScale().isEmpty()||n.isEmpty()||this.data().isEmpty())return r;const a=this.model().timeScale().visibleBarsStrictRange(),o=this.firstValue();if(null===a||null===o)return r;let l,h;if(t){const e=this.data().bars().last();if(null===e)return r;l=e.value,h=e.index}else{const e=this.data().bars().search(a.lastBar(),d.PlotRowSearchMode.NearestLeft);if(null===e)return r;l=e.value,h=e.index}const u=null!==(i=void 0!==e?l[e]:this._barFunction(l))&&void 0!==i?i:NaN,c=this.barColorer().barStyle(h,!1),_=n.priceToCoordinate(u,o),p={...n.getFormattedValues(u,o,!0),noData:!1,color:c.barColor,floatCoordinate:_,coordinate:_,index:h};return s&&(p.price=u),p}isDWM(){return this.intervalObj().isDWM()}data(){var e;return null!==(e=this._data)&&void 0!==e?e:this._seriesSource.data()}clearData(){(0,i.assert)(null===this._data,"Cannot clear loaded data"),this._seriesSource.clearData()}nearestValue(e,t,s){var i;const r=this.nearestData(e,s);return null!==(i=null==r?void 0:r.value[t])&&void 0!==i?i:void 0}onSymbolIntervalChanged(){return this._symbolIntervalChanged}onIntervalChanged(){return this._intervalChanged}onStatusChanged(){return this._onStatusChanged}onRestarted(){return this._onRestarted}onExtendedHoursChanged(){return this._extendedHoursChanged}isNeedRestart(e){return 5!==this._status&&(void 0===e&&(e=this.properties().childs().style.value()),!(0,
p.isRangeStyle)(this._prevChartStyle)&&!(0,p.isRangeStyle)(e)&&!(this._prevChartStyle===e||!(0,p.isRequiringRestartSeriesStyles)(this._prevChartStyle)&&!(0,p.isRequiringRestartSeriesStyles)(e)))}isStyleSupportedForReplay(e){return 8!==e&&(0,p.isTimeBasedStyle)(e)}sessionId(){return this.properties().childs().sessionId.value()}sessionIdChanged(){return this._sessionIdChanged}priceRange(e,t){var s,r;const n=this.m_priceScale;if(this.data().isEmpty()||!n)return null;if(n.isLockScale()){const e=this._model.mainSeriesScaleRatio();if(null!==e){const s=n.internalHeight()/(this.model().timeScale().barSpacing()/e),r=(0,i.ensureNotNull)(this.data().search(t,d.PlotRowSearchMode.NearestLeft)).value,a=((0,i.ensure)(r[2])+(0,i.ensure)(r[3]))/2;return new u.PriceRange(a-.5*s,a+.5*s)}}const a=this.priceSource();let o,l,h;if(null!==a?(o=this.data().bars().minMaxOnRangeCached(e,t,[{name:a,offset:0}]),l=this.data().nsBars().minMaxOnRangeCached(e,t,[{name:a,offset:0}])):(o=this.data().bars().minMaxOnRangeCached(e,t,[{name:"low",offset:0},{name:"high",offset:0}]),l=this.data().nsBars().minMaxOnRange(e,t,[{name:"low",offset:0},{name:"high",offset:0}])),o=(0,d.mergeMinMax)(o,l),null===o)h=new u.PriceRange(-.5,.5);else if(o.min===o.max){const e=5/(null!==(r=null===(s=this._symbolInfo)||void 0===s?void 0:s.pricescale)&&void 0!==r?r:100);h=new u.PriceRange(o.min-e,o.max+e)}else h=new u.PriceRange(o.min,o.max);return n.isLog()?new u.PriceRange(n.priceToLogical(h.minValue()),n.priceToLogical(h.maxValue())):h}autoScaleInfo(e,t){const s=this.priceRange(e,t);if(null===this._paneView)return{range:s};const i=this._paneView;return{range:s,topPixelMargin:i.topPixelMargin?i.topPixelMargin():void 0,bottomPixelMargin:i.bottomPixelMargin?i.bottomPixelMargin():void 0}}onChartStyleChanged(e=!0){var t;this._updateBarFunction(),this.isNeedRestart()&&(this.data().clear(),this.model().timeScale().scrollToRealtime(!1),this.isInReplay()&&!this.isStyleSupportedForReplay(this.style())&&this._removeReplaySubscriber(),this.restart(e));const s=this.properties();this._prevChartStyle=s.childs().style.value(),this._onStyleChanged.fire(s.childs().style.value()),this.invalidateBarStylesCache(),this._updateLastPriceAnimationActive(),(null===(t=this._styleToRecover)||void 0===t?void 0:t.originalStyle)!==this.style()&&(this._styleToRecover=null)}setChartStyleWithIntervalIfNeeded(e,t){const s=this.interval(),i=null!=t?t:(0,_t.getResolutionByChartStyle)(e,s,this._model.defaultResolutions()),r=z.Interval.isEqual(i,s);this.setSymbolParams({interval:r?void 0:i,style:e})}idForAlert(){return(0,Ce.hash)(this.getSymbolString()+z.Interval.normalize(this.interval())).toString()}alertCreationAvailable(){const e=this.symbolInfo();return new(Q())(this.hasStateForAlert()&&null!==e&&!(0,p.isEconomicSymbol)(e)).readonly()}hasStateForAlert(){return Jt}stateForAlert(){var e;const t=this.idForAlert(),s=xe.FormattersSerializer.serialize(this._formatter);let i;const r=this.isDWM()?"regular":this.sessionIdProxyProperty().value()
;if(this._symbolInfo&&this._symbolInfo.subsessions&&this._symbolInfo.subsessions.length>1){const t=null===(e=this._symbolInfo.subsessions)||void 0===e?void 0:e.find((e=>e.id===r));t&&(i=(0,Ie.translateSessionExtendedDescription)(t.description))}const n=this.properties().childs(),a={id:t,uniqueId:t,type:"MainSeries",proSymbol:this.proSymbol(),actualSymbol:this.actualSymbol(),symbolString:this.getSymbolString(),interval:this.interval(),style:n.style.value(),styleInputs:this.getInputsProperties().state(),sessionId:r,sessionDescription:i,dividendsAdjustment:n.dividendsAdjustment.value(),backAdjustment:n.backAdjustment.value()&&!this.isBackAdjustmentForbiddenProperty().value(),settlementAsClose:n.settlementAsClose.value()&&!this.isSettlementAsCloseForbiddenProperty().value(),boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount,isSpread:this.isSpread(),formatter:s},o=function(e){if(e.isSpread())return Te.DataSourceDangerReason.Spread;const t=e.symbolInfo();return t&&"CRYPTOCAP"===t.exchange?Te.DataSourceDangerReason.CryptoCap:null}(this);return o&&(a.dangerReason=o),a}styleStudyInfos(){return{haStyle:this._haStyle,renkoStyle:this._renkoStyle,pbStyle:this._pbStyle,kagiStyle:this._kagiStyle,pnfStyle:this._pnfStyle,rangeStyle:this._rangeStyle}}isSpread(){var e;return"spread"===(null===(e=this._symbolInfo)||void 0===e?void 0:e.type)}isYield(){return null!==this._symbolInfo&&(0,K.isYield)(this._symbolInfo)}sessionIdProxyProperty(){return this._sessionIdProxyProperty}symbolTextSourceProxyProperty(){return this._symbolTextSourceProxyProperty}setTextSourceIsAlwaysTickerRestrictionEnabled(e){this._textSourceIsAlwaysTickerRestrictionEnabled=e,this._recalcSymbolTextSourceProxyProperty()}isPrePostMarketPricesAvailableProperty(){return this._isPrePostMarketPricesAvailableProperty}isSettlementAsCloseForbiddenProperty(){return this._isSettlementAsCloseForbiddenProperty}isBackAdjustmentForbiddenProperty(){return this._isBackAdjustmentForbiddenProperty}invalidateBarColorerCache(){this._barColorerCache=null,this.invalidateBarStylesCache()}replayExitedDueUnsupportedInterval(){return this._replayExitedDueUnsupportedInterval}replayExitedDueUnavailableForUserInterval(){return this._replayExitedDueUnavailableForUserInterval}onTimeFrameApplied(){return this._onTimeFrameApplied}onInReplayStateChanged(){return this._onInReplayStateChanged}dataWindowView(){return this._dataWindowView}statusView(){return Xt?this._statusView:null}legendView(){return this._legendView}marketStatusModel(){return this._marketStatusModel}dataUpdatedModeModel(){return this._dataUpdatedModeModel}dataProblemModel(){return this._dataProblemModel}setDefaultTimeframe(e){this._pendingTimeRange=e}loadDataTo(e){const t=this._properties.childs().interval.value();this._onTimeFrameApplied.fire(e),this._seriesSource.modifySeries(this._getResolvingSymbolObject(),(0,_t.getServerInterval)(t),e)}isInReplay(){return null!==this._replaySubscriber}quotes(){return this.data().isEmpty()?null:this._quotesProvider.quotes()}base(){return this._base}pointValue(){
return this._pointValue}barCloseTime(){return this._lastBarCloseTime}priceSource(){let e=null;const t=this._properties.childs();switch(t.style.value()){case 2:e=t.lineStyle.childs().priceSource.value();break;case 3:e=t.areaStyle.childs().priceSource.value();break;case 10:e=t.baselineStyle.childs().priceSource.value();break;case 13:e=t.columnStyle.childs().priceSource.value()}return e}updateAllViews(e){var t,s,i,r,n,a,o,l,h;null===(t=this._paneView)||void 0===t||t.update(e),this._dataWindowView.update(),this._legendView.update(),this._statusView.update(),this._averagePaneViews.forEach((t=>t.update(e))),this._highLowAvgPaneViews.forEach((t=>t.update(e))),this._labelPaneViews.forEach((t=>t.update(e))),this._priceAxisViews.forEach((t=>t.update(e))),this._priceLineAxisViews.forEach((t=>t.update(e))),null===(s=this._futureBarsPaneView)||void 0===s||s.update(e),null===(i=this._projectionBarsPaneView)||void 0===i||i.update(e),null===(r=this._waterlineView)||void 0===r||r.update(e),null===(n=this._prevClosePriceLineView)||void 0===n||n.update(e),null===(a=this._priceLineView)||void 0===a||a.update(e),null===(o=this._gotoDateView)||void 0===o||o.update(e),null===(l=this._endOfDataPaneView)||void 0===l||l.update(e),null===(h=this._baseHorizontalLineView)||void 0===h||h.update(e);const d=this._model.activeStrategySource().value();null==d||d.updateAllViews(e),this._lineStyleLastPriceCirclePaneView.update(e)}barFunction(){return this._barFunction}precomputedBarStyle(e){return this._precomputedBarStyles.get(e)}setPrecomputedBarStyle(e,t){this._precomputedBarStyles.set(e,t)}setSymbolParams(e){const{symbol:t,interval:s,currency:i,unit:r,style:n}=e,a=this.properties().childs(),o=this._symbolInfo;let l,h,d;null!==o?(l=void 0!==t&&!(0,st.symbolSameAsCurrent)(t,o),h=void 0!==i&&!(0,st.currenciesAreSame)(i,o),d=void 0!==r&&!(0,st.unitsAreSame)(r,o,this._model.unitConversionEnabled())):(l=void 0!==t&&t!==a.symbol.value(),h=void 0!==i&&i!==a.currencyId.value(),d=void 0!==r&&r!==a.unitId.value());const u=void 0!==s&&!z.Interval.isEqual(a.interval.value(),s),c=void 0!==n&&n!==a.style.value(),_=[rs("symbol",t,l),rs("interval",s,u),rs("currency",i,h),rs("unit",r,d),rs("style",n,c)].filter((e=>null!==e)).join("; ");ts.logInfo(`Applying series symbol params: ${_}`),void 0!==t&&a.symbol.setValue(t),void 0!==i&&a.currencyId.setValue(i),void 0!==r&&a.unitId.setValue(r),u&&a.interval.setValue(s),c&&a.style.setValue(n);let p=!1;if(c){p=this.isNeedRestart();const e=!l&&(h||d);this.onChartStyleChanged(e)}!p&&(l||u||h||d)&&this._applySymbolParamsChanges({symbolChanged:l,currencyChanged:h,unitChanged:d,intervalChanged:u,styleChanged:c}),(l||h||d)&&this.model().checkLineToolSelection()}setSymbol(e){this.setSymbolParams({symbol:e})}currency(){return this.properties().childs().currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,p.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this.properties().childs().unitId.value()||null}setUnit(e){this.setSymbolParams({unit:e})}measureUnitId(){
return(0,p.measureUnitId)(this.symbolInfo())}isConvertedToOtherUnit(){return(0,p.isConvertedToOtherUnit)(this.symbolInfo(),this._model.unitConversionEnabled())}symbolSource(){return this}barsProvider(){return this}title(){return this.symbolTitle()}name(){return this.symbolTitle()}symbolTitle(e,t,s="exchange"){let i=this.properties().childs().symbol.value();const r=this.symbolInfo();if(null!==r){const{type:t}=r;i=(0,p.symbolTitle)(r,e,"forex"===t?"exchange":s)}return t?i:`${i}, ${(0,M.translatedIntervalString)(this.properties().childs().interval.value())}`}setObsoleteZOrder(e){this._obsoleteZOrder=e}obsoleteZOrder(){return this._obsoleteZOrder}valuesProvider(){return new N(this,this.model())}statusProvider(e){return new T(this,this._model.properties().childs().scalesProperties.childs().textColor,this.properties().childs().statusViewStyle,e)}open(e){const t=this.data().valueAt(e);return t&&t[1]}high(e){const t=this.data().valueAt(e);return t&&t[2]}low(e){const t=this.data().valueAt(e);return t&&t[3]}close(e){const t=this.data().valueAt(e);return t&&t[4]}moveItem(e,t,s){if(10===this.style()&&0===t){const t=this.priceScale(),s=this.properties().childs().baselineStyle,i=t.height(),r=100-e.y/i*100,n=r<0?0:Math.round(10*r)/10;s.childs().baseLevelPercentage.setValue(Math.max(Math.min(n,100),0))}}rerequestData(){this._applySymbolParamsChanges({force:!0})}switchToReplay(e,t){this._replaySubscriber=e,this._isReplayResolutionAvailableForUser=t,this._onInReplayStateChanged.fire(),this._replaySubscriber.modifySeries(this.getSymbolString(),this._properties.childs().interval.value()),this.rerequestData()}switchToRealtime(){this.isInReplay()&&(this._removeReplaySubscriber(),this.rerequestData())}requestMoreDataAvailable(){return this._requestMoreDataAvailable}seriesLoaded(){return this._seriesLoaded}endOfData(){var e;return null!==(null===(e=this._lastCompleteFlags)||void 0===e?void 0:e.data_completed)}endOfDataType(){var e,t;return null!==(t=null===(e=this._lastCompleteFlags)||void 0===e?void 0:e.data_completed)&&void 0!==t?t:null}dataPoweredBy(){return this._dataPoweredBy}boxSizeValue(){return this._boxSizeValue}isUserDeletable(){return!1}changeTimeFrame(){(0,n.trackEvent)("GUI","Change timeframe")}onTagsChanged(){return this._tagsChanged}state(e){var t;const s=this.obsoleteZOrder();let i={type:"MainSeries",id:this.id(),zorder:s,haStyle:this._haStyle,renkoStyle:this._renkoStyle,pbStyle:this._pbStyle,kagiStyle:this._kagiStyle,pnfStyle:this._pnfStyle,rangeStyle:this._rangeStyle,formattingDeps:this._formattingDeps};const r=this.properties().state();return(null===(t=this._symbolInfo)||void 0===t?void 0:t.ticker)&&(r.symbol=this._symbolInfo.ticker),this._model.unitConversionEnabled()||(r.unitId=null),i.state=r,e&&(i={...i,bars:this._barsState(this.bars()),nsBars:this._barsState(this.nsBars()),symbolInfo:this._symbolInfo,rtPrice:this.data().lastProjectionPrice,boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount}),i}restoreState(e,t){if(t&&this._setStatus(5),
!this._model.unitConversionEnabled()&&e.state&&delete e.state.unitId,this._properties.mergeAndFire(e.state),this._properties.hasChild("esdBreaksStyle")&&this._properties.removeProperty("esdBreaksStyle"),this._prevChartStyle=this.properties().childs().style.value(),this.createPaneView(),t){const t=e;this.restoreData(t.bars,t.nsBars,t.symbolInfo,t.rtPrice,t.boxSize,t.reversalAmount)}e.formattingDeps&&(this._formattingDeps=e.formattingDeps,this._recreatePriceFormattingDependencies())}restoreData(e,t,s,i,r,n){this._status=5,this._data=new h.SeriesData,this._data.bars().restoreState(e),this._data.nsBars().restoreState(t),this._updateSymbolInfo(s,!1),this._data.lastProjectionPrice=i,this._data.boxSize=r;const a=this.properties().childs();r||(6===a.style.value()?this._data.boxSize=a.pnfStyle.childs().inputs.childs().boxSize.value():4===a.style.value()&&(this._data.boxSize=a.renkoStyle.childs().inputs.childs().boxSize.value())),this._data.reversalAmount=n,n||5===a.style.value()&&(this._data.reversalAmount=a.kagiStyle.childs().inputs.childs().reversalAmount.value()),this._loading=!1}async setGotoDateResult(e){this._gotoDateResultCleared=!1;const t=await s.e(4079).then(s.bind(s,293467));this._gotoDateResultCleared||(this._gotoDateView=new t.GotoDateView(this,e),this._gotoDateView.doNotShowLastAvailableBar(this._doNotShowLastAvailableBar),this._model.updateSource(this))}clearGotoDateResult(){this._gotoDateView=null,this._gotoDateResultCleared=!0}doNotShowLastAvailableBar(e){var t;this._doNotShowLastAvailableBar=e,null===(t=this._gotoDateView)||void 0===t||t.doNotShowLastAvailableBar(e)}dataUpdated(){return this.dataEvents().dataUpdated()}_barsState(e){const t=e.state();return t.data.forEach((e=>e.value.splice(7,1))),t}_updateBarFunction(){this._barFunction=(0,jt.barFunctionByStyle)(this.style(),this.priceSource())}_setProperties(e){e.hasChild("timeframe")||e.merge({timeframe:""}),e.hasChild("shortName")||e.merge({shortName:""}),e.hasChild("currencyId")||e.addChild("currencyId",new(_())(null)),e.hasChild("unitId")||e.addChild("unitId",new(_())(null)),this._properties=e;const t=e.childs();t.currencyId.subscribe(this,this._onCurrencyChanged),t.unitId.subscribe(this,this._onUnitChanged),t.timeframe.subscribe(this,this.changeTimeFrame),e.subscribe(this,this._onPropertiesChanged)}_updateSessionIdProxyProperty(e){const t=this._properties.childs().sessionId.value();let s=t;if(e){const e=this.symbolInfo();null!==e&&(s=e.subsession_id||t)}this._ignoreSessionIdProxyPropertyChanges=!0,this._sessionIdProxyProperty.setValue(s),this._ignoreSessionIdProxyPropertyChanges=!1}_onSessionIdProxyPropertyChanged(){this._ignoreSessionIdProxyPropertyChanges||this._properties.childs().sessionId.setValue(this._sessionIdProxyProperty.value()),this._updateLastPriceAnimationActive()}_onSymbolResolved(e){this._seriesErrorMessage=null,this._updateSymbolInfo(e,!1),this._model.updateSource(this),this._model.onWidget()||((0,n.trackEvent)("Symbol",e.listed_exchange,e.name),(0,n.trackEvent)("Symbol Type",e.type,e.listed_exchange))
;const t=e.minmov/e.pricescale,s=this.properties().childs();4===s.style.value()&&s.renkoStyle.childs().inputs.childs().boxSize.value()<t?s.renkoStyle.childs().inputs.merge({boxSize:t}):6===s.style.value()&&s.pnfStyle.childs().inputs.childs().boxSize.value()<t?s.pnfStyle.childs().inputs.merge({boxSize:t}):5===s.style.value()&&s.kagiStyle.childs().inputs.childs().reversalAmount.value()<t&&s.kagiStyle.childs().inputs.merge({reversalAmount:t}),this._checkInterval(),this._checkChartStyle(),this._formattingDeps={format:e.format,pricescale:e.pricescale,minmov:e.minmov,fractional:e.fractional,minmove2:e.minmove2}}_onSymbolError(e){this._setStatus(4),this._loading=!1,this._properties.childs().shortName.setValue(this._properties.childs().symbol.value()),this._model.clearAllStudies(),this.updateAllViews((0,be.sourceChangeEvent)(this.id())),this._model.updateSource(this),e!==ct.permissionDenied&&this._model.resetTimeScale(),this._sendTelemetryCounter("symbol_error",this._getTelemetryAdditionalData(e,!1)),this._symbolResolvingActive.setValue(!1)}_sendTelemetryCounter(e,t){void 0===t&&(t=this._getTelemetryAdditionalData());const s=Object.assign({count:1},{additional:t});Pe.telemetry.sendChartReport(e,s)}_getTelemetryAdditionalData(e,t){t=void 0===t||t;const s={symbol:this.actualSymbol()};return t&&(s.resolution=this.interval()),void 0!==e&&(s.reason=e),s}_onSeriesError(e){this._loading=!1;let t=e.error;const s=e.ctx;if(s){const e={};Object.keys(s).forEach((t=>{e[t]=s[t].toString()})),t=t.format(e)}es&&ts.logNormal("Error reason: "+t),this._seriesErrorMessage=t;const i=Kt&&this._symbolInfo?10:4;this._setStatus(i),this._seriesLoaded=!0,this._sendTelemetryCounter("series_error",this._getTelemetryAdditionalData(t)),this._enablePriceRangeReady()}_onSeriesLoading(e){this._loading=!0,this._setStatus(2)}_onDataUpdated(e,t){t?this._requestMoreDataAvailable=!0:this._lastPriceAnimationActive&&this._seriesLoaded&&this._lineStyleLastPriceCirclePaneView.update((0,be.sourceChangeEvent)(this.id())),this._lastBarCloseTime=e&&e.closeTime||null,this._boxSizeValue.setValue(this.data().boxSize),this._statusView.update(),this.clearAveragePriceCache(),this.clearHighLowPriceCache();const s=this.model(),r=(0,i.ensureNotNull)(s.paneForSource(this));s.recalculatePane(r,(0,be.sourceChangeEvent)({sourceId:this.id(),realtime:!t})),s.updateSource(this)}_setStatus(e){this._status=e,this._statusView.update(),this.model().updateSource(this),this._onStatusChanged.fire()}_onBarReceived(e){this.model().recalcVisibleRangeStudies(!0)}_recreateFormatter(){var e;this._formatter=(0,p.createSeriesFormatter)(null!==(e=this.symbolInfo())&&void 0!==e?e:this._formattingDeps,this.properties().childs().minTick.value()),this._ignoreMinMoveFormatter=(0,p.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value(),!0),this.priceScale()&&this.priceScale().updateFormatter(),this._formatterChanged.fire()}_recreatePriceStep(){const{minMove:e,priceScale:t}=(0,p.getSeriesPriceFormattingState)(this.symbolInfo()),s=e/t;this._ignoreMinMovePriceStep=1/t,
this._priceStep!==s&&(this._priceStep=s,this._priceStepChanged.fire())}_recreatePriceFormattingDependencies(){this._recreateFormatter(),this._recreatePriceStep()}_onQuotesUpdate(e,t){if(Yt){const e=void 0!==t.values.change||void 0!==t.values.change_percent;e&&this._legendView.update();const s=void 0!==t.values.prev_close_price;s&&((0,i.ensureNotNull)(this._prevClosePriceLineView).update((0,be.sourceChangeEvent)(this.id())),(0,i.ensureNotNull)(this._prevClosePriceAxisView).update((0,be.sourceChangeEvent)(this.id()))),(e||s)&&this.model().updateSource(this)}void 0!==e.values.current_session&&e.values.current_session!==this._currentSession&&(this._currentSession=e.values.current_session,this._updateLastPriceAnimationActive())}_updateIsPrePostMarketPricesForbiddenProperty(){const e=(0,p.symbolHasPreOrPostMarket)(this._symbolInfo)&&(this.isDWM()||(0,p.isRegularSessionId)(this.sessionIdProxyProperty().value()));this._isPrePostMarketPricesAvailableProperty.setValue(e)}_updateSettlementAsCloseForbiddenProperty(){var e;const t=this.isDWM()&&Boolean(null===(e=this._symbolInfo)||void 0===e?void 0:e.has_settlement);this._isSettlementAsCloseForbiddenProperty.setValue(!t)}_updateBackAdjustmentForbiddenProperty(){var e;const t=Boolean(null===(e=this._symbolInfo)||void 0===e?void 0:e.has_backadjustment);this._isBackAdjustmentForbiddenProperty.setValue(!t)}_removeReplaySubscriber(){{if(!this.isInReplay())return;const e=this._replaySubscriber;this._replaySubscriber=null,this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged.fire(),null==e||e.destroy()}}_getSymbolForApi(){return(0,p.symbolForApi)(this.symbolInfo()||this._prevSymbolInfo,this.symbol())}_getSymbolObject(){const e=this._getExtendedSymbolObject();if(S.SYMBOL_STRING_DATA.hasOwnProperty(this.properties().childs().style.value())){return{symbol:e,type:this.styleStudyInfo(this.getStyleShortName()+"Style").studyId+"!",inputs:this.getInputsProperties().state()}}return e}_getExtendedSymbolObject(){const e={symbol:this._getSymbolForApi()};null!==this.currency()&&(e["currency-id"]=this.currency());const t=this.unit();this._model.unitConversionEnabled()&&null!==t&&(e["unit-id"]=t);{const t=this.properties().childs();e.adjustment=t.dividendsAdjustment.value()?"dividends":"splits",this.isDWM()||(e.session=t.sessionId.value()),t.backAdjustment.value()&&(e.backadjustment="default"),t.settlementAsClose.value()||(e["settlement-as-close"]=!1)}return e}_checkInterval(){if(this._symbolInfo){if(void 0!==this._symbolInfo.data_frequency){const e=this.interval(),t=(0,_t.getApplicableInterval)(this._symbolInfo.data_frequency,e);t!==e&&this.requestingResolutionLessThanFrequency.fire(t)}if(z.Interval.isIntraday(this.interval())&&!this._symbolInfo.has_intraday&&this.requestingIntradayWhenNotSupported.fire(),this._symbolInfo.hasOwnProperty("supported_resolutions")){const e=z.Interval.normalize(this._properties.childs().interval.value())
;null!==e&&-1===this._symbolInfo.supported_resolutions.indexOf(e)&&this.requestingResolutionWhenNotSupported.fire(this._symbolInfo.supported_resolutions[0])}}}_checkChartStyle(){const e=this.style();(0,p.isCloseBasedSymbol)(this.symbolInfo())?(0,p.isSingleValueBasedStyle)(e)||(this.requestingStyleIsNotSupported.fire(),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):null!==this._styleToRecover&&(this.requestingStyleSupportRecovered.fire(this._styleToRecover.originalStyle),this._styleToRecover=null)}_updateSymbolInfo(e,t){if(this._prevSymbolInfo=t?this._symbolInfo:null,this._symbolInfo=e,e){const t=this._properties.childs();t.shortName.setValue(e.name);const s=(0,p.extractSymbolNameFromSymbolInfo)(e,this.symbol());s&&t.symbol.setValue(s);const i=(0,p.symbolCurrency)(e),r=(0,p.symbolUnit)(e,this._model.unitConversionEnabled());"alwaysOff"===(0,j.currencyUnitVisibilityProperty)().value()||i===t.currencyId.value()&&r===t.unitId.value()||this._model.fullUpdate(),t.currencyId.setValue(i),t.unitId.setValue(r),this._updateSessionIdProxyProperty(!0)}this._base=e?e.pricescale/e.minmov:100,this._pointValue=e&&e.pointvalue||1;const s=(0,it.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getExtendedSymbolObject());this._quotesProvider.setQuotesSessionSymbol(s),this._marketStatusModel.setSymbolInfo(e),e&&this._recreatePriceFormattingDependencies(),this._statusView.update(),this.priceScale().updateFormatter(),this._symbolResolvingActive.setValue(!e),this._dataPoweredBy=(0,we.getDataVendorString)(e),this._updateIsPrePostMarketPricesForbiddenProperty(),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty()}_createHighLowAvgViews(){const e=this.properties().childs().highLowAvgPrice,t=this._getHighLowPrice.bind(this),s=function(e,t,s,i){const r=s.childs(),n=Ke(e,t,{label:Qe,labelVisible:r.highLowPriceLabelsVisible,lineVisible:r.highLowPriceLinesVisible,lineColor:r.highLowPriceLinesColor,lineWidth:r.highLowPriceLinesWidth},(()=>i(0))),a=Ke(e,t,{label:Je,labelVisible:r.highLowPriceLabelsVisible,lineVisible:r.highLowPriceLinesVisible,lineColor:r.highLowPriceLinesColor,lineWidth:r.highLowPriceLinesWidth},(()=>i(1)));return{paneViews:[n.paneView,a.paneView],panePriceAxisViews:[n.panePriceAxisView,a.panePriceAxisView],priceAxisViews:[n.priceAxisView,a.priceAxisView],priceLineAxisViews:[n.priceLineAxisView,a.priceLineAxisView]}}(this._model,this,e,t);this._highLowAvgPaneViews.push(...s.paneViews),this._labelPaneViews.push(...s.panePriceAxisViews),this._priceAxisViews.push(...s.priceAxisViews),this._priceLineAxisViews.push(...s.priceLineAxisViews)}_createAverageViews(){}_getHighLowPrice(e){if(!this._highLowPriceCache.has(e)){const e=this._model.timeScale().visibleBarsStrictRange();if(null===e)return null;const t=function(e,t,s){return e.minMaxOnRangeCached(t,s,[{name:"low",offset:0},{name:"high",offset:0}])}(this._model.mainSeries().bars(),e.firstBar(),e.lastBar());if(null===t)return null;this._highLowPriceCache.set(1,t.min),this._highLowPriceCache.set(0,t.max)}
return this._highLowPriceCache.get(e)}_getAveragePrice(e){return null}_onSeriesCompleted(e){var t;this._sendTelemetryCounter("series_loaded",this._getTelemetryAdditionalData()),this._loading=!1,this._seriesErrorMessage=null;let r=e.updateMode;switch("pulsed"===r&&(r="delayed"),r){case"streaming":this._setStatus(3);break;case"endofday":this._setStatus(6);break;case"delayed":this._setStatus(8);break;case"replay":this._setStatus(11)}r.match(/delayed_streaming/)&&this._setStatus(9),this._lastCompleteFlags=null!==(t=e.flags)&&void 0!==t?t:null;const n=(0,i.ensureNotNull)(this._model.paneForSource(this));n.recalculatePriceScale(this.priceScale(),(0,be.sourceChangeEvent)(this.id()));const a=dt.InvalidationMask.full();if(null!==this._model.appliedTimeFrame().value()&&a.lockVisibleTimeRangeOnResize(),this._model.invalidate(a),this.model().recalcVisibleRangeStudies(!0),this.model().recalcStudyBasedLineTools(),!this.priceScale().isLockScale()||this.model().timeScale().isEmpty()||this._seriesLoaded||(this.model().timeScale().correctOffset(),this.model().timeScale().correctBarSpacing(),this.model().resetPriceScale(n,this.priceScale())),this._seriesLoaded=!0,!ss){ss=!0;(0,s(975420).trackTiming)("Chart","Time to series",window.performance.now())}this.requestMoreData(),this._enablePriceRangeReady()}_notifyIntervalChanged(e){var t,s;const i={timeframe:null!==(t=this._pendingTimeRange)&&void 0!==t?t:void 0};this._intervalChanged.fire(e,i),this._pendingTimeRange=null!==(s=i.timeframe)&&void 0!==s?s:null}_onCurrencyChanged(){this._currencyChanged.fire()}_onUnitChanged(){this._unitChanged.fire()}_applySymbolParamsChanges(e){this._lastCompleteFlags=null,this.clearGotoDateResult();const t=this.interval(),s=this.currency(),r=this.unit(),n=z.Interval.isRange(t);n&&this._properties.childs().rangeStyle.childs().inputs.childs().range.setValue(z.Interval.parse(t).multiplier());const{symbolChanged:a,intervalChanged:o,currencyChanged:l,unitChanged:h,force:d}=e,u=o&&z.Interval.parse(t).isDWM()!=z.Interval.parse(t).isDWM();if((null!==s&&l||null!==r&&h)&&this.isInReplay()){const e=this.symbolInfo();(null===e||null!==s&&e.original_currency_id!==s||null!==r&&e.original_unit_id!==r)&&this._removeReplaySubscriber()}if(this._syncModel=null,this._prevRequestedInterval=t,5!==this._status&&(!this._seriesSource.isStarted()||a||l||h||u)&&this._updateSymbolInfo(null,!a&&(l||h)),this.isInReplay()){const e=()=>this._removeReplaySubscriber();a?e():o&&(n?e():(0,i.ensureNotNull)(this._isReplayResolutionAvailableForUser)(t)?this._isIntervalSupported(t)||(e(),this._replayExitedDueUnsupportedInterval.fire()):(e(),this._replayExitedDueUnavailableForUserInterval.fire()))}if(5===this._status)return void this._model.realignLineTools();this._loading=!0,this._setStatus(1),this._updateIsPrePostMarketPricesForbiddenProperty(),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty(),this._symbolIntervalChanged.fire(),o&&this._notifyIntervalChanged(t),this._onRestarted.fire(),this._seriesLoaded=!1,
this._lineStyleLastPriceCirclePaneView.stopAnimation();let c=null;this._pendingTimeRange&&(c=this._pendingTimeRange,this._pendingTimeRange=null),this._onTimeFrameApplied.fire(c),this._onBeforeModifySeries(this.getSymbolString(),t),this._data=null,this._seriesSource.modifySeries(this._getResolvingSymbolObject(),(0,_t.getServerInterval)(t),c,d),this._seriesSource.isStarted()||(this._predictBars=0,this._seriesSource.start()),(a||l||h)&&this.disablePriceRangeReady(),this.updateAllViews((0,be.sourceChangeEvent)(this.id())),this._model.lightUpdate()}_isIntervalSupported(e){return!this.isInReplay()||(0,i.ensureNotNull)(this._replaySubscriber).canChangeResolution(e)}_onBeforeModifySeries(e,t){this._replaySubscriber&&this._replaySubscriber.modifySeries(e,t)}_getResolvingSymbolObject(){let e=this._getSymbolObject();return this._replaySubscriber&&(e=this._replaySubscriber.generateReplaySymbol(e)),e}_onSessionIdPropertyChanged(){this._sessionIdChanged.fire(),this.isDWM()||(this.restart(),this._updateLastPriceAnimationActive())}_subscribeRestartToSessionIdChange(){this.properties().childs().sessionId.subscribe(this,this._onSessionIdPropertyChangedBound)}_unsubscribeRestartToSessionIdChange(){this.properties().childs().sessionId.unsubscribe(this,this._onSessionIdPropertyChangedBound)}_updateLastPriceAnimationActive(){if(!this._options.lastPriceAnimationEnabled)return;const e=this._lastPriceAnimationActive,t=this.properties().childs(),s=t.style.value();if(this._model.isSnapshot()||!t.visible.value()||3!==s&&10!==s&&2!==s)this._lastPriceAnimationActive=!1;else{const e=this.currentSession(),t=!(0,p.isRegularSessionId)(this.sessionIdProxyProperty().value())&&!this.isDWM();this._lastPriceAnimationActive="market"===e||t&&("pre_market"===e||"post_market"===e)}this._lastPriceAnimationActive&&e!==this._lastPriceAnimationActive&&this.model().invalidate(dt.InvalidationMask.cursor())}_onPropertiesChanged(e){const t=this._properties.childs();e!==t.symbol&&e!==t.interval&&e!==t.timeframe&&(this._tagsChanged.fire(),this.createPaneView(),this.updateAllViews((0,be.sourceChangeEvent)(this._id)),this.model().updateSource(this),(0,a.emit)("series_properties_changed",this._id))}_recalcSymbolTextSourceProxyProperty(){this._textSourceIsAlwaysTickerRestrictionEnabled?this._symbolTextSourceProxyProperty.setValue("ticker"):this._symbolTextSourceProxyProperty.setValue(this._properties.childs().statusViewStyle.childs().symbolTextSource.value())}_clearStylePlot(e,t){if(0===e.size())return;if(void 0===t&&e!==this.nsBars())return void(this._precomputedBarStyles=new WeakMap);const s=null!=t?t:(0,i.ensureNotNull)(e.firstIndex()),r=(0,i.ensureNotNull)(e.lastIndex())+1;e.range(s,r).each(((e,t)=>(this._precomputedBarStyles.delete(t),!1)))}}},404703:(e,t,s)=>{var i=s(232567);TradingView.DEFAULT_BAR_COUNT=300,TradingView.TIME_PLOT=0,TradingView.OPEN_PLOT=1,TradingView.HIGH_PLOT=2,TradingView.LOW_PLOT=3,TradingView.CLOSE_PLOT=4,TradingView.ADT_PLOT=6
;var r=s(588537).ensureNotNull,n=s(468369).SeriesBase,a=s(850979).FutureBarsPaneView,o=s(345848).trackEvent,l=s(911905).getLogger("Chart.Series"),h=s(195048),d=s(621579).SeriesHorizontalBaseLinePaneView,u=s(198796).deepExtend,c=s(251954),_=s(285055).TIMEFRAMETYPE,p=s(749473).isSingleValueBasedStyle;class m extends n{constructor(e,t,s,i){t.removeProperty("currencyId"),super(e,t,s,i),this._chartApi=e._chartApi,this.createPaneView(),this._properties.addExclusion&&(this._properties.addExclusion("visible"),this._properties.addExclusion("currencyId")),this._futureBarsPaneView=null,this.properties().minTick.listeners().subscribe(this,m.prototype._recreateFormatter);var r=this;this.properties().minTick.listeners().subscribe(null,(function(){r._model.fullUpdate()})),this._priceLineView=null,this._baseHorizontalLineView=new d(this),this.bindStyleChange(),this.bindJapChartsInputs(),this._createIsDWMProperty(),this.createDividendsAdjustmentProperty(),this.dividendsAdjustment.listeners().subscribe(this,(function(){this.restart()})),this._dataPoweredBy=null,this.properties().showCountdown.listeners().subscribe(this,m.prototype._onChangeShowCountdown),this._onChangeShowCountdown(this.properties().showCountdown),this._recreatePriceFormattingDependencies(),this.properties().lineStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this.properties().areaStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this.properties().baselineStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this.properties().columnStyle.priceSource.listeners().subscribe(this,this._updateBarFunction),this._updateBarFunction()}isLoading(){return this._loading}styleStudyInfo(e){return this.styleStudyInfos()[e]}priceLineColor(e){return this.properties().priceLineColor.value()||e}serverTimeOffset(){return this._chartApi.serverTimeOffset()}_onChangeShowCountdown(e){var t=this;e.value()?this._countdownUpdateTimer=this._model.setInterval((function(){t._priceAxisView.updateCountdown()}),500):(this._model.clearInterval(this._countdownUpdateTimer),delete this._countdownUpdateTimer)}_createIsDWMProperty(){this._isDWMProperty=new i(this.isDWM()),this._onRestarted.subscribe(this,(function(){this._isDWMProperty.setValue(this.isDWM())}))}isDWMProperty(){return this._isDWMProperty}fixLastBar(e){this._futureBarsPaneView||(this._futureBarsPaneView=new a(this.model().timeScale(),this,this.bars().lastIndex(),e))}isPulse(){return this._symbolInfo&&this._symbolInfo.resolutions.length>0}seriesSource(){return this._seriesSource}_onSeriesTimeFrame(e,t,s,i,r){var n=p(this.style())?e+.5:e,a=t;if(void 0===r)null!==s&&s.type!==_.PeriodBack||(a+=this._model.studyAwareDefaultRightOffset());else if(r.applyDefaultRightMargin)a+=this._model.studyAwareDefaultRightOffset();else if(r.percentRightMargin){var o=t-n+1,l=Math.max(0,Math.min(.99,r.percentRightMargin/100));a+=l*o/(1-l)}this._model.setTimeViewport(n,a)}hl2(e){return(this.high(e)+this.low(e))/2}hlc3(e){return(this.high(e)+this.low(e)+this.close(e))/3}ohlc4(e){
return(this.open(e)+this.high(e)+this.low(e)+this.close(e))/4}nearestData(e,t){if(TradingView.isInteger(e)){var s=this.data().search(e,t);return null!==s?s:void 0}l.logDebug("Series.nearestData: incorrect logicalPoint")}nearestIndex(e,t){var s=this.nearestData(e,t);return s?s.index:void 0}purgeSymbolInfo(){this._symbolInfo=null}requestMoreData(e){if((this._status===m.STATUS_READY||this._status===m.STATUS_PULSE||this._status===m.STATUS_DELAYED||this._status===m.STATUS_DELAYED_STREAMING||this._status===m.STATUS_EOD||this._status===m.STATUS_REPLAY)&&!this._model.timeScale().isEmpty()){var t=this._model.timeScale().visibleBarsStrictRange();if(null!==t&&0!==this.bars().size()){var s=t.lastBar()-r(this.data().last()).index;if(this._predictBars<s&&(this._predictBars=s,this._seriesSource.requestMoreTickmarks(s)),this._requestMoreDataAvailable){var i=r(this.bars().firstIndex()),n=e||i-t.firstBar();n<=0||(Number.isFinite(n)?(this._requestMoreDataAvailable=!1,this._loading=!0,this._seriesSource.requestMoreData(n),this._setStatus(m.STATUS_LOADING)):l.logWarn("requestMoreData: invalid bar count: "+n+", visible bars: ["+t.firstBar()+", "+t.lastBar()+"], last index: "+r(this.data().last()).index+", predicted bars: "+this._predictBars+", required bars:"+e))}}}}bindStyleChange(){var e=this;Object.keys(m.STYLE_SHORT_NAMES).map((function(e){return m.STYLE_SHORT_NAMES[e]+"Style"})).forEach((function(t){e._properties[t].listeners().subscribe(e,m.prototype.invalidateBarStylesCache)}))}bindJapChartsInputs(){this._properties.renkoStyle.inputs.boxSize.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.wicks.listeners().subscribe(this,this.onInputChanged),this._properties.renkoStyle.inputs.sources.listeners().subscribe(this,this.onInputChanged),this._properties.pbStyle.inputs.lb.listeners().subscribe(this,this.onInputChanged),this._properties.kagiStyle.inputs.reversalAmount.listeners().subscribe(this,this.onInputChanged),this._properties.kagiStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this._properties.kagiStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.boxSize.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.reversalAmount.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.sources.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.style.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.atrLength.listeners().subscribe(this,this.onInputChanged),this._properties.pnfStyle.inputs.oneStepBackBuilding.listeners().subscribe(this,this.onInputChanged),this._properties.rangeStyle.inputs.phantomBars.listeners().subscribe(this,this.onInputChanged)}createDividendsAdjustmentProperty(){var e=this;e.dividendsAdjustment=new i;var t=function(){
var t=e._properties.dividendsAdjustment.value();e.dividendsAdjustment.setValue(t),o("Dividends adjust",!0===t?"On":"Off")};e._properties.dividendsAdjustment.listeners().subscribe(null,t),t()}dividendsAdjustmentProperty(){return this._properties.dividendsAdjustment}applyPreferences(e){var t=u({},e);this.m_priceScale.setMode({autoScale:t.priceAxisProperties.autoScale,percentage:t.priceAxisProperties.percentage,log:t.priceAxisProperties.log,lockScale:t.priceAxisProperties.lockScale}),this.setChartStyleWithIntervalIfNeeded(t.style),delete t.style,delete t.interval,this._properties.mergePreferences(t),this._properties.saveDefaults(),this.createPaneView(),this.invalidateBarStylesCache()}onInputChanged(){this.restart()}getStyleShortName(){var e=this._properties.style.value();if(m.STYLE_SHORT_NAMES.hasOwnProperty(e))return m.STYLE_SHORT_NAMES[e];throw new Error("Missed short name for style "+e)}getStyleProperties(){return this._properties[this.getStyleShortName()+"Style"]}getInputsProperties(){return this.getStyleProperties().inputs||new i}getInputsInfoProperties(){return this.getStyleProperties().inputInfo||new i}getSymbolName(){return this._symbolInfo?this._symbolInfo.name:""}priceScale(){return this.m_priceScale}setPriceScale(e){this.m_priceScale!==e&&(this._priceScaleAboutToBeChanged.fire(),this.m_priceScale=e,this._properties.removeProperty("priceAxisProperties"),this._properties.addChild("priceAxisProperties",e.properties()),this._properties.priceAxisProperties.childChanged(),c.emit("series_event","price_scale_changed"),this._priceScaleChanged.fire(e))}getSourceIcon(){return{type:"loadSvg",svgId:"series."+this.properties().style.value()}}isStyleSupported(e){return!this.isInReplay()||this.isStyleSupportedForReplay(e)}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),this.clearGotoDateResult(),this._legendView.destroy(),this._marketStatusModel.destroy(),null!==this._dataUpdatedModeModel&&this._dataUpdatedModeModel.destroy(),this._dataProblemModel.destroy(),this._paneView&&this._paneView.destroy&&this._paneView.destroy(),this._seriesSource.destroy(),super.destroy()}dataEvents(){return this._seriesSource.dataEvents()}moveData(e){return this._seriesSource.moveData(e)}}Object.assign(m,h),TradingView.Series=m,t.Series=m,t.isSeries=function(e){return e instanceof m}},621579:(e,t,s)=>{s.d(t,{SeriesHorizontalBaseLinePaneView:()=>r});var i=s(406059);class r extends i.SeriesHorizontalLinePaneView{constructor(e){super(e)}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.priceScale().mode();if(!e.percentage&&!e.indexedTo100)return;const t=this._series.firstValue();null!==t&&(this._lineRendererData.visible=!0,this._lineRendererData.y=this._series.priceScale().priceToCoordinate(t,t),this._lineRendererData.color=this._series.properties().childs().baseLineColor.value())}}},406059:(e,t,s)=>{s.d(t,{SeriesHorizontalLinePaneView:()=>r});var i=s(350985);class r extends i.HorizontalLinePaneView{constructor(e){super(),this._series=e,this._model=e.model()}}},647527:(e,t,s)=>{
s.d(t,{translateSessionDescription:()=>n,translateSessionShortDescription:()=>o,translateSessionExtendedDescription:()=>l});var i=s(575932);const r=new Map([["Premarket",(0,i.t)("Premarket",{context:"sessions"})],["Postmarket",(0,i.t)("Postmarket",{context:"sessions"})],["Regular Trading Hours",(0,i.t)("Regular trading hours",{context:"sessions"})],["Extended Trading Hours",(0,i.t)("Extended trading hours",{context:"sessions"})],["Electronic Trading Hours",(0,i.t)("Electronic trading hours",{context:"sessions"})]]);function n(e){var t;return null!==(t=r.get(e))&&void 0!==t?t:e}const a=new Map([["Premarket",(0,i.t)("PRE",{context:"sessions"})],["Postmarket",(0,i.t)("POST",{context:"sessions"})],["Regular Trading Hours",(0,i.t)("RTH",{context:"sessions"})],["Extended Trading Hours",(0,i.t)("ETH",{context:"sessions"})],["Electronic Trading Hours",(0,i.t)("ETH",{context:"sessions"})]]);function o(e){var t;return null!==(t=a.get(e))&&void 0!==t?t:e}function l(e){var t;return null!==(t=r.get(e))&&void 0!==t?t:e}},97985:(e,t,s)=>{function i(e){return e+""}s.r(t),s.d(t,{appendEllipsis:()=>i})},184601:(e,t,s)=>{s.r(t),s.d(t,{htmlEscape:()=>n,removeTags:()=>a,removeSpaces:()=>o,capitalizeFirstLetterInWord:()=>l});const i=/[<"'&>]/g,r=e=>`&#${e.charCodeAt(0)};`;function n(e){return e.replace(i,r)}function a(e=""){return e.replace(/(<([^>]+)>)/gi,"")}function o(e=""){return e.replace(/\s+/g,"")}function l(e=""){return e.replace(/\b\w/g,(e=>e.toUpperCase()))}},975420:(e,t,s)=>{s.d(t,{initGA:()=>h,trackTiming:()=>d});var i=s(251954),r=s(261030),n=s(588948),a=s(638456),o=s(691805);let l=!1;function h(){if(l)return;(0,n.updateInitData)();const e=(0,n.getInitData)();if(!e.gaId)return;l=!0,(0,o.appendScript)(`https://www.googletagmanager.com/gtag/js?id=${(0,n.getInitData)().gaId}`),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const t={optimize_id:e.optimizeId,anonymize_ip:!0};window.TVD&&(t.app_name="TVD",t.app_version=(0,a.desktopAppVersion)()),e.gaVars&&window.gtag("set",e.gaVars),window.gtag("consent","default",{analytics_storage:(0,r.getCookieSetting)(r.CookieSettings.Analytics)?"granted":"denied"}),window.gtag("config",e.gaId,t),i.subscribe(r.cookieSettingsChangeEvent,((e,t)=>{e===r.CookieSettings.Analytics&&window.gtag("consent","update",{analytics_storage:t?"granted":"denied"})}),null)}function d(e,t,s,i){h(),window.gtag("event","timing_complete",{name:t,value:s,event_category:e,event_label:i})}},72368:(e,t,s)=>{s.d(t,{isMobile:()=>a,isPlatformMobile:()=>o,canShowNewSymbolSearch:()=>l,getCurrentLocaleInfoCountry:()=>h});var i=s(314802),r=s(611688),n=s(638456);function a(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return n.CheckMobile.any()&&!e}function o(){return!(0,i.isOnMobileAppPage)("any")&&a()}function l(){return!r.enabled("widget")&&!(0,i.isOnMobileAppPage)("any")}function h(){var e,t;return null===(t=null===(e=window.initData)||void 0===e?void 0:e.currentLocaleInfo)||void 0===t?void 0:t.flag.toUpperCase()}
},888778:(e,t,s)=>{s.d(t,{initSymbolListService:()=>n});var i=s(564894);const r={id:"SymbolListService"};function n(){return Promise.all([Promise.all([s.e(93921),s.e(29594),s.e(91622),s.e(20583),s.e(49609),s.e(1026)]).then(s.bind(s,63299)),Promise.all([s.e(93921),s.e(29594),s.e(91622),s.e(20583),s.e(49609),s.e(1026)]).then(s.bind(s,38506)),Promise.all([s.e(93921),s.e(29594),s.e(91622),s.e(20583),s.e(49609),s.e(1026)]).then(s.bind(s,850935)),Promise.all([s.e(93921),s.e(29594),s.e(91622),s.e(20583),s.e(49609),s.e(1026)]).then(s.bind(s,244692))]).then((([e,t,s,n])=>{if((0,i.hasService)(r))return(0,i.service)(r);const{store:a,runner:o}=e.configureStore(),l=o.run(t.symbolListRepositorySaga);return(0,i.registerService)(r,{store:a,runner:o,actions:{addSymbols:n.addSymbolsThunk,initWidget:s.initWidget,saveListAs:n.saveListAsThunk,createNewWatchList:n.userCreateWatchlistThunk},task:l}),(0,i.service)(r)}))}},889267:(e,t,s)=>{s.d(t,{symbolTokenEscapeRe:()=>a,tokenize:()=>h});var i=s(611688),r=s(173777);const n=i.enabled("charting_library_base")?/(?:[^-+\/*^\s]'|[a-zA-Z0-9_\u0370-\u1FFF_\u2E80-\uFFFF^])(?:[^-+\/*^\s]'|[a-zA-Z0-9_\u0020\u0370-\u1FFF_\u2E80-\uFFFF_!:.&])*|'.+?'/:/(?:[^-+\/*^\s]'|[a-zA-Z0-9_\u0370-\u1FFF_\u2E80-\uFFFF])(?:[^-+\/*^\s]'|[a-zA-Z0-9_\u0020\u0370-\u1FFF_\u2E80-\uFFFF_!|:.&])*|'.+?'/,a=/[+\-/*]/,o={number:/\d+(?:\.\d*|(?![a-zA-Z0-9_!:.&]))|\.\d+/,incompleteNumber:/\./,symbol:n,incompleteSymbol:/'[^']*/,separatorPrefix:r.SEPARATOR_PREFIX,openBrace:"(",closeBrace:")",plus:"+",minus:"-",multiply:"*",divide:"/",power:"^",whitespace:/[\0-\x20\s]+/,unparsed:null},l=new RegExp(Object.values(o).map((e=>{return null===e?"":`(${"string"==typeof e?(t=e,t.replace(/[\^$()[\]{}*+?|\\]/g,"\\$&")):e.source})`;var t})).filter((e=>""!==e)).concat(".").join("|"),"g");function h(e){if(!e)return[];const t=[],s=Object.keys(o);let i;for(;i=l.exec(e);){let e=!1;for(let r=s.length;r--;)if(i[r+1]){s[r]&&t.push({value:i[r+1],type:s[r],precedence:0,offset:i.index}),e=!0;break}e||t.push({value:i[0],type:"unparsed",precedence:0,offset:i.index})}return t}}}]);